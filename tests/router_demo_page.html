<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juris Router - Comprehensive Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 10px;
        }

        .header p {
            text-align: center;
            font-size: 1.2rem;
            color: #666;
        }

        .demo-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .nav-bar {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .nav-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            transform: translateY(-1px);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-card {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }

        .info-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .info-card p {
            color: #666;
            line-height: 1.6;
        }

        .route-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 20px;
        }

        .route-input {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .route-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-section {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .search-bar {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .filter-select {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .results-display {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            padding: 15px;
            min-height: 60px;
            border: 1px dashed #667eea;
        }

        .guards-demo {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .auth-panel {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 20px;
        }

        .auth-status {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .auth-status.authenticated {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .auth-status.guest {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }

        .protected-routes {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 20px;
        }

        .code-block {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin-top: 15px;
            border-left: 4px solid #667eea;
        }

        .url-display {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            border: 1px solid #ddd;
            margin-bottom: 15px;
        }

        .segment-tree {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #ddd;
        }

        .segment-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .segment-item:last-child {
            border-bottom: none;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #f44336;
            margin-bottom: 15px;
        }

        .success-message {
            background: rgba(76, 175, 80, 0.1);
            color: #4caf50;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4caf50;
            margin-bottom: 15px;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #666;
        }

        .breadcrumb-item {
            color: #667eea;
            text-decoration: none;
            cursor: pointer;
        }

        .breadcrumb-item:hover {
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #ccc;
        }

        @media (max-width: 768px) {
            .guards-demo {
                grid-template-columns: 1fr;
            }
            
            .nav-bar {
                justify-content: center;
            }
            
            .route-form {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧭 Juris Router</h1>
            <p>Comprehensive demonstration of headless routing with reactive state management</p>
        </div>

        <div id="app"></div>
    </div>

    <!-- Include Juris and Router scripts -->
    <script src="../src/headless/juris-router.js"></script>
    <script src="../src/juris-headless.js"></script>
    <script src="../src/juris.js"></script>

    <script>
        // Initialize Juris with router as headless component
        const juris = new Juris({
            features: {
                headless: HeadlessManager
            },
            headlessComponents: {
                router: {
                    fn: Router,
                    options: {
                        autoInit: true,
                        config: {
                            mode: 'hash', // Use hash mode for demo
                            statePath: 'router',
                            routes: {
                                '/': { name: 'home', title: 'Home' },
                                '/products': { name: 'products', title: 'Products' },
                                '/products/:category': { name: 'category', title: 'Category' },
                                '/products/:category/:id': { name: 'product', title: 'Product Details' },
                                '/users': { name: 'users', title: 'Users', guards: ['requireAuth'] },
                                '/users/:id': { name: 'user-profile', title: 'User Profile', guards: ['requireAuth'] },
                                '/admin': { name: 'admin', title: 'Admin Panel', guards: ['requireAuth', 'requireAdmin'] },
                                '/admin/users': { name: 'admin-users', title: 'User Management', guards: ['requireAuth', 'requireAdmin'] },
                                '/login': { name: 'login', title: 'Login' },
                                '/about': { name: 'about', title: 'About Us' },
                                '/search': { name: 'search', title: 'Search Results' },
                                '/404': { name: 'not-found', title: 'Page Not Found' }
                            },
                            defaultRoute: '/',
                            notFoundRoute: '/404',
                            parseQuery: true,
                            segmentParsing: {
                                enabled: true,
                                maxDepth: 5,
                                customKeys: ['section', 'subsection', 'item', 'subitem'],
                                includeEmpty: false
                            },
                            globalGuards: {
                                beforeEnter: [
                                    (newUrl, oldUrl) => {
                                        juris.setState('navigation.lastAttempt', newUrl);
                                        juris.setState('navigation.fromUrl', oldUrl);
                                        return true;
                                    }
                                ],
                                afterEnter: [
                                    (newUrl) => {
                                        juris.setState('navigation.successful', newUrl);
                                        juris.setState('navigation.timestamp', Date.now());
                                    }
                                ]
                            },
                            events: {
                                onGuardFail: (newUrl, oldUrl) => {
                                    juris.setState('navigation.guardFailed', {
                                        attempted: newUrl,
                                        from: oldUrl,
                                        timestamp: Date.now()
                                    });
                                },
                                beforeChange: (newUrl, oldUrl) => {
                                    juris.setState('navigation.changing', true);
                                    return true;
                                },
                                afterChange: (newUrl, oldUrl) => {
                                    juris.setState('navigation.changing', false);
                                }
                            }
                        }
                    }
                }
            }
        });

        // Get router API
        const router = juris.getHeadlessAPI('router');

        // Initialize app state
        juris.setState('auth.isAuthenticated', false);
        juris.setState('auth.user', null);
        juris.setState('auth.role', 'guest');
        juris.setState('search.query', '');
        juris.setState('search.category', '');
        juris.setState('search.sort', 'name');

        // Add route guards
        router.addGuard('beforeEnter', async (newUrl, oldUrl, routeMatch) => {
            if (routeMatch?.route?.guards?.includes('requireAuth')) {
                const isAuth = juris.getState('auth.isAuthenticated', false);
                if (!isAuth) {
                    juris.setState('auth.redirectAfterLogin', newUrl);
                    return false;
                }
            }
            
            if (routeMatch?.route?.guards?.includes('requireAdmin')) {
                const role = juris.getState('auth.role', 'guest');
                if (role !== 'admin') {
                    return false;
                }
            }
            
            return true;
        });

        // Create main application layout
        const layout = {
            div: {
                children: [
                    // Breadcrumb Navigation
                    {
                        div: {
                            class: 'demo-section',
                            children: [
                                {
                                    h2: {
                                        class: 'section-title',
                                        text: '🗂️ Breadcrumb Navigation'
                                    }
                                },
                                {
                                    div: {
                                        class: 'breadcrumb',
                                        children: () => {
                                            const segments = juris.getState('router.segments', {});
                                            const parts = segments.parts || [];
                                            
                                            if (parts.length === 0) {
                                                return [{ span: { text: 'Home', class: 'breadcrumb-item' } }];
                                            }
                                            
                                            const breadcrumbs = [
                                                {
                                                    a: {
                                                        text: 'Home',
                                                        class: 'breadcrumb-item',
                                                        onclick: () => router.navigate('/')
                                                    }
                                                }
                                            ];
                                            
                                            parts.forEach((part, index) => {
                                                breadcrumbs.push(
                                                    { span: { text: '>', class: 'breadcrumb-separator' } },
                                                    {
                                                        a: {
                                                            text: part.charAt(0).toUpperCase() + part.slice(1),
                                                            class: 'breadcrumb-item',
                                                            onclick: () => {
                                                                const path = '/' + parts.slice(0, index + 1).join('/');
                                                                router.navigate(path);
                                                            }
                                                        }
                                                    }
                                                );
                                            });
                                            
                                            return breadcrumbs;
                                        }
                                    }
                                }
                            ]
                        }
                    },

                    // Current Route Information
                    {
                        div: {
                            class: 'demo-section',
                            children: [
                                {
                                    h2: {
                                        class: 'section-title',
                                        text: '📍 Current Route Information'
                                    }
                                },
                                {
                                    div: {
                                        class: 'url-display',
                                        text: () => {
                                            const path = juris.getState('router.path', '/');
                                            const query = juris.getState('router.query', {});
                                            const hash = juris.getState('router.hash', '');
                                            
                                            let url = `Path: ${path}`;
                                            if (Object.keys(query).length > 0) {
                                                url += ` | Query: ${JSON.stringify(query)}`;
                                            }
                                            if (hash) {
                                                url += ` | Hash: ${hash}`;
                                            }
                                            return url;
                                        }
                                    }
                                },
                                {
                                    div: {
                                        class: 'info-grid',
                                        children: [
                                            {
                                                div: {
                                                    class: 'info-card',
                                                    children: [
                                                        { h3: { text: 'Route Parameters' } },
                                                        {
                                                            p: {
                                                                text: () => {
                                                                    const params = juris.getState('router.params', {});
                                                                    return Object.keys(params).length > 0 
                                                                        ? JSON.stringify(params, null, 2)
                                                                        : 'No parameters';
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'info-card',
                                                    children: [
                                                        { h3: { text: 'Segments' } },
                                                        {
                                                            div: {
                                                                class: 'segment-tree',
                                                                children: () => {
                                                                    const segments = juris.getState('router.segments', {});
                                                                    const items = [];
                                                                    
                                                                    if (segments.section) {
                                                                        items.push({
                                                                            div: {
                                                                                class: 'segment-item',
                                                                                children: [
                                                                                    { span: { text: 'Section:' } },
                                                                                    { strong: { text: segments.section } }
                                                                                ]
                                                                            }
                                                                        });
                                                                    }
                                                                    
                                                                    if (segments.subsection) {
                                                                        items.push({
                                                                            div: {
                                                                                class: 'segment-item',
                                                                                children: [
                                                                                    { span: { text: 'Subsection:' } },
                                                                                    { strong: { text: segments.subsection } }
                                                                                ]
                                                                            }
                                                                        });
                                                                    }
                                                                    
                                                                    if (segments.item) {
                                                                        items.push({
                                                                            div: {
                                                                                class: 'segment-item',
                                                                                children: [
                                                                                    { span: { text: 'Item:' } },
                                                                                    { strong: { text: segments.item } }
                                                                                ]
                                                                            }
                                                                        });
                                                                    }
                                                                    
                                                                    return items.length > 0 ? items : [{ p: { text: 'Root level' } }];
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },

                    // Navigation Demo
                    {
                        div: {
                            class: 'demo-section',
                            children: [
                                {
                                    h2: {
                                        class: 'section-title',
                                        text: '🚀 Navigation Demo'
                                    }
                                },
                                {
                                    div: {
                                        class: 'nav-bar',
                                        children: [
                                            {
                                                button: {
                                                    text: 'Home',
                                                    class: () => {
                                                        const path = juris.getState('router.path', '/');
                                                        return path === '/' ? 'nav-btn active' : 'nav-btn';
                                                    },
                                                    onclick: () => router.navigate('/')
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'Products',
                                                    class: () => {
                                                        const path = juris.getState('router.path', '/');
                                                        return path.startsWith('/products') ? 'nav-btn active' : 'nav-btn';
                                                    },
                                                    onclick: () => router.navigate('/products')
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'Electronics',
                                                    class: () => {
                                                        const path = juris.getState('router.path', '/');
                                                        return path === '/products/electronics' ? 'nav-btn active' : 'nav-btn';
                                                    },
                                                    onclick: () => router.navigate('/products/electronics')
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'Laptop Details',
                                                    class: () => {
                                                        const path = juris.getState('router.path', '/');
                                                        return path === '/products/electronics/laptop-123' ? 'nav-btn active' : 'nav-btn';
                                                    },
                                                    onclick: () => router.navigate('/products/electronics/laptop-123?variant=16gb&color=silver')
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'Search',
                                                    class: () => {
                                                        const path = juris.getState('router.path', '/');
                                                        return path === '/search' ? 'nav-btn active' : 'nav-btn';
                                                    },
                                                    onclick: () => router.navigate('/search')
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'About',
                                                    class: () => {
                                                        const path = juris.getState('router.path', '/');
                                                        return path === '/about' ? 'nav-btn active' : 'nav-btn';
                                                    },
                                                    onclick: () => router.navigate('/about')
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    div: {
                                        class: 'route-form',
                                        children: [
                                            {
                                                input: {
                                                    type: 'text',
                                                    class: 'route-input',
                                                    placeholder: 'Enter route (e.g., /products/electronics/laptop-123?variant=16gb)',
                                                    value: () => juris.getState('navigation.customRoute', ''),
                                                    oninput: (e) => juris.setState('navigation.customRoute', e.target.value)
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'Navigate',
                                                    class: 'nav-btn',
                                                    onclick: () => {
                                                        const route = juris.getState('navigation.customRoute', '');
                                                        if (route) {
                                                            router.navigate(route);
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'Back',
                                                    class: 'nav-btn',
                                                    onclick: () => router.back()
                                                }
                                            },
                                            {
                                                button: {
                                                    text: 'Forward',
                                                    class: 'nav-btn',
                                                    onclick: () => router.forward()
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },

                    // Search & Filters Demo
                    {
                        div: {
                            class: 'demo-section',
                            children: [
                                {
                                    h2: {
                                        class: 'section-title',
                                        text: '🔍 Search & Filters Demo'
                                    }
                                },
                                {
                                    div: {
                                        class: 'search-section',
                                        children: [
                                            {
                                                input: {
                                                    type: 'text',
                                                    class: 'search-bar',
                                                    placeholder: 'Search products...',
                                                    value: () => juris.getState('router.query.q', ''),
                                                    oninput: (e) => {
                                                        const currentPath = juris.getState('router.path', '/');
                                                        const query = juris.getState('router.query', {});
                                                        const newQuery = { ...query, q: e.target.value };
                                                        
                                                        if (currentPath !== '/search') {
                                                            router.navigate('/search');
                                                        }
                                                        
                                                        setTimeout(() => {
                                                            const url = router.buildUrl('/search', {}, newQuery);
                                                            router.navigate(url);
                                                        }, 10);
                                                    }
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'filters',
                                                    children: [
                                                        {
                                                            select: {
                                                                class: 'filter-select',
                                                                value: () => juris.getState('router.query.category', ''),
                                                                onchange: (e) => {
                                                                    const query = juris.getState('router.query', {});
                                                                    const newQuery = { ...query, category: e.target.value };
                                                                    const url = router.buildUrl('/search', {}, newQuery);
                                                                    router.navigate(url);
                                                                },
                                                                children: [
                                                                    { option: { value: '', text: 'All Categories' } },
                                                                    { option: { value: 'electronics', text: 'Electronics' } },
                                                                    { option: { value: 'books', text: 'Books' } },
                                                                    { option: { value: 'clothing', text: 'Clothing' } },
                                                                    { option: { value: 'home', text: 'Home & Garden' } }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            select: {
                                                                class: 'filter-select',
                                                                value: () => juris.getState('router.query.sort', 'name'),
                                                                onchange: (e) => {
                                                                    const query = juris.getState('router.query', {});
                                                                    const newQuery = { ...query, sort: e.target.value };
                                                                    const url = router.buildUrl('/search', {}, newQuery);
                                                                    router.navigate(url);
                                                                },
                                                                children: [
                                                                    { option: { value: 'name', text: 'Sort by Name' } },
                                                                    { option: { value: 'price', text: 'Sort by Price' } },
                                                                    { option: { value: 'date', text: 'Sort by Date' } },
                                                                    { option: { value: 'rating', text: 'Sort by Rating' } }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            button: {
                                                                text: 'Clear Filters',
                                                                class: 'nav-btn',
                                                                onclick: () => {
                                                                    router.navigate('/search');
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'results-display',
                                                    children: [
                                                        {
                                                            div: {
                                                                text: () => {
                                                                    const query = juris.getState('router.query', {});
                                                                    const path = juris.getState('router.path', '/');
                                                                    
                                                                    if (path !== '/search') {
                                                                        return 'Navigate to search to see results';
                                                                    }
                                                                    
                                                                    const parts = [];
                                                                    if (query.q) parts.push(`Search: "${query.q}"`);
                                                                    if (query.category) parts.push(`Category: ${query.category}`);
                                                                    if (query.sort) parts.push(`Sort: ${query.sort}`);
                                                                    
                                                                    return parts.length > 0 
                                                                        ? `Searching with filters: ${parts.join(' | ')}`
                                                                        : 'No search filters applied';
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },

                    // Route Guards Demo
                    {
                        div: {
                            class: 'demo-section',
                            children: [
                                {
                                    h2: {
                                        class: 'section-title',
                                        text: '🛡️ Route Guards Demo'
                                    }
                                },
                                {
                                    div: {
                                        class: 'guards-demo',
                                        children: [
                                            {
                                                div: {
                                                    class: 'auth-panel',
                                                    children: [
                                                        { h3: { text: 'Authentication Status' } },
                                                        {
                                                            div: {
                                                                class: () => {
                                                                    const isAuth = juris.getState('auth.isAuthenticated', false);
                                                                    return isAuth ? 'auth-status authenticated' : 'auth-status guest';
                                                                },
                                                                text: () => {
                                                                    const isAuth = juris.getState('auth.isAuthenticated', false);
                                                                    const role = juris.getState('auth.role', 'guest');
                                                                    return isAuth ? `Authenticated as ${role}` : 'Not authenticated';
                                                                }
                                                            }
                                                        },
                                                        {
                                                            button: {
                                                                text: () => {
                                                                    const isAuth = juris.getState('auth.isAuthenticated', false);
                                                                    return isAuth ? 'Logout' : 'Login as User';
                                                                },
                                                                class: 'nav-btn',
                                                                onclick: () => {
                                                                    const isAuth = juris.getState('auth.isAuthenticated', false);
                                                                    if (isAuth) {
                                                                        juris.setState('auth.isAuthenticated', false);
                                                                        juris.setState('auth.user', null);
                                                                        juris.setState('auth.role', 'guest');
                                                                        router.navigate('/');
                                                                    } else {
                                                                        juris.setState('auth.isAuthenticated', true);
                                                                        juris.setState('auth.user', { id: 1, name: 'John Doe' });
                                                                        juris.setState('auth.role', 'user');
                                                                        
                                                                        // Check for redirect
                                                                        const redirectUrl = juris.getState('auth.redirectAfterLogin');
                                                                        if (redirectUrl) {
                                                                            juris.setState('auth.redirectAfterLogin', null);
                                                                            router.navigate(redirectUrl);
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            button: {
                                                                text: 'Login as Admin',
                                                                class: 'nav-btn',
                                                                onclick: () => {
                                                                    juris.setState('auth.isAuthenticated', true);
                                                                    juris.setState('auth.user', { id: 2, name: 'Admin User' });
                                                                    juris.setState('auth.role', 'admin');
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'protected-routes',
                                                    children: [
                                                        { h3: { text: 'Protected Routes' } },
                                                        {
                                                            div: {
                                                                children: [
                                                                    {
                                                                        button: {
                                                                            text: 'Users Page (Auth Required)',
                                                                            class: 'nav-btn',
                                                                            onclick: () => router.navigate('/users')
                                                                        }
                                                                    },
                                                                    {
                                                                        button: {
                                                                            text: 'User Profile (Auth Required)',
                                                                            class: 'nav-btn',
                                                                            onclick: () => router.navigate('/users/123')
                                                                        }
                                                                    },
                                                                    {
                                                                        button: {
                                                                            text: 'Admin Panel (Admin Required)',
                                                                            class: 'nav-btn',
                                                                            onclick: () => router.navigate('/admin')
                                                                        }
                                                                    },
                                                                    {
                                                                        button: {
                                                                            text: 'User Management (Admin Required)',
                                                                            class: 'nav-btn',
                                                                            onclick: () => router.navigate('/admin/users')
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            div: {
                                                                children: () => {
                                                                    const guardFailed = juris.getState('navigation.guardFailed');
                                                                    if (guardFailed) {
                                                                        return [{
                                                                            div: {
                                                                                class: 'error-message',
                                                                                text: `Access denied to: ${guardFailed.attempted}`
                                                                            }
                                                                        }];
                                                                    }
                                                                    return [];
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },

                    // Router Utilities Demo
                    {
                        div: {
                            class: 'demo-section',
                            children: [
                                {
                                    h2: {
                                        class: 'section-title',
                                        text: '🔧 Router Utilities Demo'
                                    }
                                },
                                {
                                    div: {
                                        class: 'info-grid',
                                        children: [
                                            {
                                                div: {
                                                    class: 'info-card',
                                                    children: [
                                                        { h3: { text: 'Route Matching' } },
                                                        {
                                                            p: {
                                                                text: () => {
                                                                    const currentPath = juris.getState('router.path', '/');
                                                                    const match = router.matchRoute(currentPath);
                                                                    return match ? 
                                                                        `Matched route: ${match.path} (${match.route.name || 'unnamed'})` :
                                                                        'No route matched';
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'info-card',
                                                    children: [
                                                        { h3: { text: 'Active Route Check' } },
                                                        {
                                                            p: {
                                                                text: () => {
                                                                    const isHomeActive = router.isActive('/', true);
                                                                    const isProductsActive = router.isActive('/products');
                                                                    return `Home active: ${isHomeActive}, Products active: ${isProductsActive}`;
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'info-card',
                                                    children: [
                                                        { h3: { text: 'URL Building' } },
                                                        {
                                                            p: {
                                                                text: () => {
                                                                    const builtUrl = router.buildUrl('/products/:category/:id', 
                                                                        { category: 'electronics', id: 'laptop-456' }, 
                                                                        { variant: '32gb', color: 'black' }
                                                                    );
                                                                    return `Built URL: ${builtUrl}`;
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'info-card',
                                                    children: [
                                                        { h3: { text: 'Navigation State' } },
                                                        {
                                                            p: {
                                                                text: () => {
                                                                    const isChanging = juris.getState('navigation.changing', false);
                                                                    const lastAttempt = juris.getState('navigation.lastAttempt', 'none');
                                                                    return isChanging ? 
                                                                        'Navigation in progress...' : 
                                                                        `Last attempt: ${lastAttempt}`;
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },

                    // Debug Information
                    {
                        div: {
                            class: 'demo-section',
                            children: [
                                {
                                    h2: {
                                        class: 'section-title',
                                        text: '🐛 Debug Information'
                                    }
                                },
                                {
                                    div: {
                                        class: 'code-block',
                                        text: () => {
                                            const routerState = {
                                                path: juris.getState('router.path'),
                                                segments: juris.getState('router.segments'),
                                                params: juris.getState('router.params'),
                                                query: juris.getState('router.query'),
                                                hash: juris.getState('router.hash')
                                            };
                                            
                                            const navigationState = {
                                                changing: juris.getState('navigation.changing'),
                                                lastAttempt: juris.getState('navigation.lastAttempt'),
                                                guardFailed: juris.getState('navigation.guardFailed'),
                                                timestamp: juris.getState('navigation.timestamp')
                                            };
                                            
                                            return `Router State:\n${JSON.stringify(routerState, null, 2)}\n\nNavigation State:\n${JSON.stringify(navigationState, null, 2)}`;
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ]
            }
        };

        // Set the layout and render
        juris.layout = layout;
        juris.render('#app');

        // Add some helpful console methods
        window.jurisRouter = {
            navigate: (path) => router.navigate(path),
            getState: () => juris.getState('router'),
            getCurrentPath: () => router.getCurrentPath(),
            isActive: (path, exact) => router.isActive(path, exact),
            buildUrl: (path, params, query) => router.buildUrl(path, params, query),
            matchRoute: (path) => router.matchRoute(path)
        };

        console.log('🧭 Juris Router Demo loaded!');
        console.log('Try: jurisRouter.navigate("/products/electronics/laptop-123?variant=16gb")');
        console.log('Or use the UI above to explore routing features');
    </script>
</body>
</html>