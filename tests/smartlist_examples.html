<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartList Reusable Component Examples</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            color: #333;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
        }

        .example-section {
            background: #f8faff;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e0e7ff;
        }

        .example-title {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }

        input, select {
            padding: 6px 10px;
            border: 2px solid #e0e7ff;
            border-radius: 6px;
            font-size: 12px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        /* SmartList default styles */
        .smartlist {
            background: white;
            border-radius: 8px;
            padding: 15px;
            min-height: 100px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .smartlist-item {
            background: white;
            border: 2px solid #e0e7ff;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .smartlist-item:hover {
            border-color: #667eea;
            transform: translateY(-1px);
        }

        .smartlist-empty {
            text-align: center;
            color: #666;
            padding: 40px;
            font-style: italic;
        }

        .smartlist-loading {
            text-align: center;
            color: #667eea;
            padding: 20px;
            background: #f0f4ff;
            border-radius: 8px;
            animation: pulse 2s infinite;
        }

        .smartlist-error {
            text-align: center;
            color: #dc2626;
            background: #fef2f2;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #fecaca;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Todo specific styles */
        .todo-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .todo-item.completed {
            opacity: 0.6;
        }

        .todo-item.completed .todo-title {
            text-decoration: line-through;
        }

        .todo-content {
            flex: 1;
        }

        .todo-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .todo-meta {
            font-size: 11px;
            color: #666;
            display: flex;
            gap: 8px;
        }

        .priority-badge {
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-high { background: #fee2e2; color: #dc2626; }
        .priority-medium { background: #fef3c7; color: #d97706; }
        .priority-low { background: #e0f2fe; color: #0284c7; }

        /* Product card styles */
        .product-card {
            border: 1px solid #e0e7ff;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }

        .product-image {
            width: 100%;
            height: 120px;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 14px;
        }

        .product-info {
            padding: 12px;
        }

        .product-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .product-price {
            color: #667eea;
            font-weight: 600;
        }

        /* Deep reactive element styles */
        .reactive-section {
            margin-top: 8px;
            padding: 8px;
            background: #f8faff;
            border-radius: 6px;
            border: 1px solid #e0e7ff;
        }

        .reactive-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 6px;
        }

        .reactive-row:last-child {
            margin-bottom: 0;
        }

        .reactive-counter {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .reactive-counter:hover {
            background: #5a67d8;
            transform: scale(1.05);
        }

        .reactive-timer {
            background: #10b981;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-family: monospace;
        }

        .animated-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .animated-box.normal {
            background: #f59e0b;
        }

        .animated-box.spinning {
            background: #ef4444;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .live-status {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #dcfce7;
            color: #166534;
        }

        .status-idle {
            background: #fef3c7;
            color: #92400e;
        }

        .status-processing {
            background: #dbeafe;
            color: #1e40af;
        }

        .temperature-gauge {
            width: 60px;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .temperature-fill {
            height: 100%;
            transition: all 0.3s ease;
            border-radius: 4px;
        }

        .notification-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: #ef4444;
            color: white;
            font-size: 9px;
            padding: 2px 5px;
            border-radius: 8px;
            min-width: 16px;
            text-align: center;
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        .message-item.unread {
            background: #eff6ff;
            border-left-color: #3b82f6;
            font-weight: 600;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .message-sender {
            font-weight: 600;
            color: #374151;
        }

        .message-time {
            font-size: 11px;
            color: #6b7280;
        }

        .message-content {
            color: #4b5563;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <!-- Load Juris and SmartList -->
    <script src="../src/juris.js"></script>
    <script src="reusable_smartlist.js"></script>

    <script>

function examplePromise() {
  return new Promise((resolve, reject) => {
    // Simulate async operation with setTimeout
    setTimeout(() => {
      const success = Math.random() > 0.5; // Random success/failure
      
      if (success) {
        resolve("Operation completed successfully!");
      } else {
        reject("Operation failed");
      }
    }, 1000);
  });
}
    
const Increment = (props, {getState,setState}) => (
  {button: {
    text: ()=>props.lable(),
    onclick: () => {
        const current = getState('count', 0);
        setState('count', current + 1);
    }
  }});
	const Counter = (props, {getState,setState}) => ({
      div: {
          children:[
            2,
            {h1: {
                  text: () => `Count: ${getState('count', 0)}`
            }}, 
            "Hello",
            {br:{}},
            {Increment:{lable:()=>'Increment:'+ getState('count', 0)}},
            ()=>{
                if(getState('count', 0) < 5){
                  return `Count: ${getState('count', 0)}`
                }
                if(getState('count', 0)<10){
                  return {h1: {
                        text: () => `Count 2: ${getState('count', 0)}`
                  }}
                }

                return {Increment:{lable:()=>'Increment:'+ getState('count', 0)}}

            },
            ()=>examplePromise()
            .then(result => console.log(result))
            .catch(error => console.error(error)),
            
            {
              div:{
                children:[
                  {
                  div:{
                    style:{
                      color:'red',
                    },
                    children:()=>{
                      return {
                          div:{
                            children:[
                              {div:{
                                children:[
                                  "child"
                                  ]
                              }}
                            ]
                          }
                        }
                      }
                    }
                  }
                ]
              }
            }
          ]
      }
  });
        // Initialize Juris
        const juris = new Juris({
            states: {
                todos: [],
                products: [],
                messages: [],
                settings: {
                    showCompleted: true
                },
                // Reactive states for deep nested elements
                timers: {},
                counters: {},
                liveData: {},
                animations: {},
                notifications: {}
            }
            ,components:{
                Increment,
                Counter
            }
        });

        // Register the reusable SmartList component
        SmartList.register(juris);

        // Helper functions
        function generateId() {
            return Date.now() + Math.random().toString(36).substr(2, 9);
        }

        // Reactive helpers for deep nested elements
        function startItemTimer(itemId) {
            const timerPath = `timers.${itemId}`;
            if (juris.getState(timerPath) === null) {
                juris.setState(timerPath, 0);
                const interval = setInterval(() => {
                    const current = juris.getState(timerPath, 0);
                    if (current !== null) {
                        juris.setState(timerPath, current + 1);
                    } else {
                        clearInterval(interval);
                    }
                }, 1000);
                // Store interval ID for cleanup
                juris.setState(`timers.${itemId}_interval`, interval);
            }
        }

        function stopItemTimer(itemId) {
            const intervalId = juris.getState(`timers.${itemId}_interval`);
            if (intervalId) {
                clearInterval(intervalId);
                juris.setState(`timers.${itemId}_interval`, null);
            }
            juris.setState(`timers.${itemId}`, null);
        }

        function incrementCounter(itemId) {
            const counterPath = `counters.${itemId}`;
            const current = juris.getState(counterPath, 0);
            juris.setState(counterPath, current + 1);
            
            // Add notification
            const notificationPath = `notifications.${itemId}`;
            juris.setState(notificationPath, current + 1);
            
            // Clear notification after 2 seconds
            setTimeout(() => {
                const currentNotification = juris.getState(notificationPath, 0);
                if (currentNotification === current + 1) {
                    juris.setState(notificationPath, 0);
                }
            }, 2000);
        }

        function updateLiveData(itemId) {
            const liveDataPath = `liveData.${itemId}`;
            juris.setState(liveDataPath, {
                temperature: Math.floor(Math.random() * 100),
                status: ['active', 'idle', 'processing'][Math.floor(Math.random() * 3)],
                lastPing: new Date().toLocaleTimeString(),
                batteryLevel: Math.floor(Math.random() * 100),
                signal: Math.floor(Math.random() * 5) + 1
            });
        }

        function toggleAnimation(itemId) {
            const animPath = `animations.${itemId}`;
            const current = juris.getState(animPath, false);
            juris.setState(animPath, !current);
        }

        // Auto-update live data periodically
        setInterval(() => {
            const todos = juris.getState('todos', []);
            todos.forEach(todo => {
                if (Math.random() < 0.3) { // 30% chance to update each item
                    updateLiveData(todo.id);
                }
            });
        }, 3000);

        // Sample data generators
        const sampleTodos = [
            { id: '1', title: 'Review quarterly reports', completed: false, priority: 'high', category: 'work' },
            { id: '2', title: 'Buy groceries', completed: true, priority: 'medium', category: 'personal' },
            { id: '3', title: 'Call dentist', completed: false, priority: 'low', category: 'health' },
            { id: '4', title: 'Update website', completed: false, priority: 'high', category: 'work' }
        ];

        const sampleProducts = [
            { id: 'p1', name: 'Wireless Headphones', price: 99.99, category: 'electronics', inStock: true },
            { id: 'p2', name: 'Running Shoes', price: 129.95, category: 'sports', inStock: false },
            { id: 'p3', name: 'Coffee Maker', price: 79.50, category: 'kitchen', inStock: true },
            { id: 'p4', name: 'Notebook', price: 12.99, category: 'office', inStock: true }
        ];

        const sampleMessages = [
            { id: 'm1', sender: 'Alice Johnson', content: 'Hey, are we still on for the meeting tomorrow?', time: '10:30 AM', unread: true },
            { id: 'm2', sender: 'Bob Smith', content: 'The project proposal looks great!', time: '9:15 AM', unread: false },
            { id: 'm3', sender: 'Carol Wilson', content: 'Can you review the latest designs when you get a chance?', time: '8:45 AM', unread: true }
        ];

        // Todo list component with SmartList
        juris.registerComponent('TodoExample', (props, context) => {
            return {
                div: {
                    class: 'example-section',
                    children: [
                        { div: { class: 'example-title', text: '📝 Todo List Example' } },
                        
                        // Controls
                        {
                            div: {
                                class: 'controls',
                                children: [
                                    { input: { id: 'todoInput', type: 'text', placeholder: 'New todo...' } },
                                    {
                                        select: {
                                            id: 'todoPriority',
                                            children: [
                                                { option: { value: 'low', text: 'Low' } },
                                                { option: { value: 'medium', text: 'Medium' } },
                                                { option: { value: 'high', text: 'High' } }
                                            ]
                                        }
                                    },
                                    {
                                        button: {
                                            class: 'btn',
                                            text: 'Add',
                                            onclick: () => {
                                                const input = document.getElementById('todoInput');
                                                const priority = document.getElementById('todoPriority');
                                                
                                                if (input.value.trim()) {
                                                    const todos = juris.getState('todos', []);
                                                    juris.setState('todos', [...todos, {
                                                        id: generateId(),
                                                        title: input.value.trim(),
                                                        completed: false,
                                                        priority: priority.value,
                                                        category: 'general'
                                                    }]);
                                                    input.value = '';
                                                }
                                            }
                                        }
                                    },
                                    {
                                        button: {
                                            class: 'btn secondary',
                                            text: 'Sample Data',
                                            onclick: () => {
                                                juris.setState('todos', sampleTodos);
                                                // Initialize reactive states for sample todos
                                                setTimeout(() => {
                                                    sampleTodos.forEach(todo => {
                                                        startItemTimer(todo.id);
                                                        updateLiveData(todo.id);
                                                    });
                                                }, 100);
                                            }
                                        }
                                    },
                                    {
                                        button: {
                                            class: 'btn danger',
                                            text: 'Clear',
                                            onclick: () => juris.setState('todos', [])
                                        }
                                    }
                                ]
                            }
                        },

                        // SmartList for todos
                        {
                            SmartList: {
                                items: () => {
                                    const todos = juris.getState('todos', []);
                                    const showCompleted = juris.getState('settings.showCompleted', true);
                                    return showCompleted ? todos : todos.filter(t => !t.completed);
                                },
                                renderItem: (todo, index, context) => {
                                    // Start timer for this item (deep reactive element)
                                    startItemTimer(todo.id);

                                    return {
                                        div: {
                                            class: `todo-item ${todo.completed ? 'completed' : ''}`,
                                            style: { position: 'relative' },
                                            children: [
                                                // Notification badge (reactive)
                                                () => {
                                                    const notificationCount = juris.getState(`notifications.${todo.id}`, 0);
                                                    return notificationCount > 0 ? {
                                                        div: {
                                                            class: 'notification-badge',
                                                            text: notificationCount
                                                        }
                                                    } : null;
                                                },
                                                
                                                {
                                                    input: {
                                                        type: 'checkbox',
                                                        checked: todo.completed,
                                                        onchange: (e) => {
                                                            const todos = juris.getState('todos', []);
                                                            const updated = todos.map(t => 
                                                                t.id === todo.id ? { ...t, completed: e.target.checked } : t
                                                            );
                                                            juris.setState('todos', updated);
                                                        }
                                                    }
                                                },
                                                
                                                {
                                                    div: {
                                                        class: 'todo-content',
                                                        children: [
                                                            { div: { class: 'todo-title', text: todo.title } },
                                                            {
                                                                div: {
                                                                    class: 'todo-meta',
                                                                    children: [
                                                                        { span: { class: `priority-badge priority-${todo.priority}`, text: todo.priority } },
                                                                        { span: { text: todo.category } }
                                                                    ]
                                                                }
                                                            },
                                                            
                                                            // DEEP REACTIVE SECTION - These elements update independently
                                                            {
                                                                div: {
                                                                    class: 'reactive-section',
                                                                    children: [
                                                                        {
                                                                            div: {
                                                                                class: 'reactive-row',
                                                                                children: [
                                                                                    // Reactive counter (updates only when clicked)
                                                                                    {
                                                                                        span: {
                                                                                            class: 'reactive-counter',
                                                                                            text: () => `Clicks: ${juris.getState(`counters.${todo.id}`, 0)}`,
                                                                                            onclick: () => incrementCounter(todo.id),
                                                                                            title: 'Click to increment counter'
                                                                                        }
                                                                                    },
                                                                                    // Reactive timer (updates every second)
                                                                                    {
                                                                                        span: {
                                                                                            class: 'reactive-timer',
                                                                                            text: () => {
                                                                                                const seconds = juris.getState(`timers.${todo.id}`, 0);
                                                                                                const mins = Math.floor(seconds / 60);
                                                                                                const secs = seconds % 60;
                                                                                                return `${mins}:${secs.toString().padStart(2, '0')}`;
                                                                                            },
                                                                                            title: 'Running timer'
                                                                                        }
                                                                                    },
                                                                                    // Animated box (toggles animation state)
                                                                                    {
                                                                                        div: {
                                                                                            class: () => {
                                                                                                const isSpinning = juris.getState(`animations.${todo.id}`, false);
                                                                                                return `animated-box ${isSpinning ? 'spinning' : 'normal'}`;
                                                                                            },
                                                                                            onclick: () => toggleAnimation(todo.id),
                                                                                            title: 'Click to toggle animation'
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        },
                                                                        
                                                                        {
                                                                            div: {
                                                                                class: 'reactive-row',
                                                                                children: [
                                                                                    // Manual live data update button
                                                                                    {
                                                                                        button: {
                                                                                            class: 'btn',
                                                                                            style: { fontSize: '10px', padding: '4px 8px' },
                                                                                            text: '🔄 Update',
                                                                                            onclick: () => updateLiveData(todo.id)
                                                                                        }
                                                                                    },
                                                                                    // Live status indicator
                                                                                    {
                                                                                        span: {
                                                                                            class: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `live-status status-${liveData.status || 'idle'}`;
                                                                                            },
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return liveData.status || 'idle';
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    // Temperature gauge
                                                                                    {
                                                                                        div: {
                                                                                            class: 'temperature-gauge',
                                                                                            title: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `Temperature: ${liveData.temperature || 0}°C`;
                                                                                            },
                                                                                            children: [
                                                                                                {
                                                                                                    div: {
                                                                                                        class: 'temperature-fill',
                                                                                                        style: () => {
                                                                                                            const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                            const temp = liveData.temperature || 0;
                                                                                                            const width = temp + '%';
                                                                                                            const color = temp > 70 ? '#ef4444' : temp > 40 ? '#f59e0b' : '#10b981';
                                                                                                            return { width, backgroundColor: color };
                                                                                                        }
                                                                                                    }
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    // Temperature value
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `${liveData.temperature || 0}°C`;
                                                                                            },
                                                                                            style: {
                                                                                                fontSize: '10px',
                                                                                                color: '#666'
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        },
                                                                        
                                                                        // Live data info row
                                                                        {
                                                                            div: {
                                                                                style: {
                                                                                    fontSize: '9px',
                                                                                    color: '#999',
                                                                                    marginTop: '4px'
                                                                                },
                                                                                children: [
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return liveData.lastPing ? `Last: ${liveData.lastPing}` : 'No data';
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    { span: { text: ' | ' } },
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `Battery: ${liveData.batteryLevel || 0}%`;
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    { span: { text: ' | ' } },
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                const signal = liveData.signal || 0;
                                                                                                return `Signal: ${'📶'.repeat(signal)}${'📵'.repeat(5-signal)}`;
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    {Counter:{}},
                                                                                    {Increment:{}}
                                                                                ]
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                
                                                {
                                                    button: {
                                                        class: 'btn danger',
                                                        text: '×',
                                                        onclick: () => {
                                                            // Clean up timers when removing todo
                                                            stopItemTimer(todo.id);
                                                            juris.setState(`counters.${todo.id}`, null);
                                                            juris.setState(`liveData.${todo.id}`, null);
                                                            juris.setState(`animations.${todo.id}`, null);
                                                            juris.setState(`notifications.${todo.id}`, null);
                                                            
                                                            const todos = juris.getState('todos', []);
                                                            const updated = todos.filter(t => t.id !== todo.id);
                                                            juris.setState('todos', updated);
                                                        }
                                                    }
                                                },
                                                {
                            SmartList: {
                                items: () => {
                                    const todos = juris.getState('todos', []);
                                    const showCompleted = juris.getState('settings.showCompleted', true);
                                    return showCompleted ? todos : todos.filter(t => !t.completed);
                                },
                                renderItem: (todo, index, context) => {
                                    // Start timer for this item (deep reactive element)
                                    startItemTimer(todo.id);

                                    return {
                                        div: {
                                            class: `todo-item ${todo.completed ? 'completed' : ''}`,
                                            style: { position: 'relative' },
                                            children: [
                                                // Notification badge (reactive)
                                                () => {
                                                    const notificationCount = juris.getState(`notifications.${todo.id}`, 0);
                                                    return notificationCount > 0 ? {
                                                        div: {
                                                            class: 'notification-badge',
                                                            text: notificationCount
                                                        }
                                                    } : null;
                                                },
                                                
                                                {
                                                    input: {
                                                        type: 'checkbox',
                                                        checked: todo.completed,
                                                        onchange: (e) => {
                                                            const todos = juris.getState('todos', []);
                                                            const updated = todos.map(t => 
                                                                t.id === todo.id ? { ...t, completed: e.target.checked } : t
                                                            );
                                                            juris.setState('todos', updated);
                                                        }
                                                    }
                                                },
                                                
                                                {
                                                    div: {
                                                        class: 'todo-content',
                                                        children: [
                                                            { div: { class: 'todo-title', text: todo.title } },
                                                            {
                                                                div: {
                                                                    class: 'todo-meta',
                                                                    children: [
                                                                        { span: { class: `priority-badge priority-${todo.priority}`, text: todo.priority } },
                                                                        { span: { text: todo.category } }
                                                                    ]
                                                                }
                                                            },
                                                            
                                                            // DEEP REACTIVE SECTION - These elements update independently
                                                            {
                                                                div: {
                                                                    class: 'reactive-section',
                                                                    children: [
                                                                        {
                                                                            div: {
                                                                                class: 'reactive-row',
                                                                                children: [
                                                                                    // Reactive counter (updates only when clicked)
                                                                                    {
                                                                                        span: {
                                                                                            class: 'reactive-counter',
                                                                                            text: () => `Clicks: ${juris.getState(`counters.${todo.id}`, 0)}`,
                                                                                            onclick: () => incrementCounter(todo.id),
                                                                                            title: 'Click to increment counter'
                                                                                        }
                                                                                    },
                                                                                    // Reactive timer (updates every second)
                                                                                    {
                                                                                        span: {
                                                                                            class: 'reactive-timer',
                                                                                            text: () => {
                                                                                                const seconds = juris.getState(`timers.${todo.id}`, 0);
                                                                                                const mins = Math.floor(seconds / 60);
                                                                                                const secs = seconds % 60;
                                                                                                return `${mins}:${secs.toString().padStart(2, '0')}`;
                                                                                            },
                                                                                            title: 'Running timer'
                                                                                        }
                                                                                    },
                                                                                    // Animated box (toggles animation state)
                                                                                    {
                                                                                        div: {
                                                                                            class: () => {
                                                                                                const isSpinning = juris.getState(`animations.${todo.id}`, false);
                                                                                                return `animated-box ${isSpinning ? 'spinning' : 'normal'}`;
                                                                                            },
                                                                                            onclick: () => toggleAnimation(todo.id),
                                                                                            title: 'Click to toggle animation'
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        },
                                                                        
                                                                        {
                                                                            div: {
                                                                                class: 'reactive-row',
                                                                                children: [
                                                                                    // Manual live data update button
                                                                                    {
                                                                                        button: {
                                                                                            class: 'btn',
                                                                                            style: { fontSize: '10px', padding: '4px 8px' },
                                                                                            text: '🔄 Update',
                                                                                            onclick: () => updateLiveData(todo.id)
                                                                                        }
                                                                                    },
                                                                                    // Live status indicator
                                                                                    {
                                                                                        span: {
                                                                                            class: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `live-status status-${liveData.status || 'idle'}`;
                                                                                            },
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return liveData.status || 'idle';
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    // Temperature gauge
                                                                                    {
                                                                                        div: {
                                                                                            class: 'temperature-gauge',
                                                                                            title: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `Temperature: ${liveData.temperature || 0}°C`;
                                                                                            },
                                                                                            children: [
                                                                                                {
                                                                                                    div: {
                                                                                                        class: 'temperature-fill',
                                                                                                        style: () => {
                                                                                                            const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                            const temp = liveData.temperature || 0;
                                                                                                            const width = temp + '%';
                                                                                                            const color = temp > 70 ? '#ef4444' : temp > 40 ? '#f59e0b' : '#10b981';
                                                                                                            return { width, backgroundColor: color };
                                                                                                        }
                                                                                                    }
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    // Temperature value
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `${liveData.temperature || 0}°C`;
                                                                                            },
                                                                                            style: {
                                                                                                fontSize: '10px',
                                                                                                color: '#666'
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        },
                                                                        
                                                                        // Live data info row
                                                                        {
                                                                            div: {
                                                                                style: {
                                                                                    fontSize: '9px',
                                                                                    color: '#999',
                                                                                    marginTop: '4px'
                                                                                },
                                                                                children: [
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return liveData.lastPing ? `Last: ${liveData.lastPing}` : 'No data';
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    { span: { text: ' | ' } },
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                return `Battery: ${liveData.batteryLevel || 0}%`;
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    { span: { text: ' | ' } },
                                                                                    {
                                                                                        span: {
                                                                                            text: () => {
                                                                                                const liveData = juris.getState(`liveData.${todo.id}`, {});
                                                                                                const signal = liveData.signal || 0;
                                                                                                return `Signal: ${'📶'.repeat(signal)}${'📵'.repeat(5-signal)}`;
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                
                                                {
                                                    button: {
                                                        class: 'btn danger',
                                                        text: '×',
                                                        onclick: () => {
                                                            // Clean up timers when removing todo
                                                            stopItemTimer(todo.id);
                                                            juris.setState(`counters.${todo.id}`, null);
                                                            juris.setState(`liveData.${todo.id}`, null);
                                                            juris.setState(`animations.${todo.id}`, null);
                                                            juris.setState(`notifications.${todo.id}`, null);
                                                            
                                                            const todos = juris.getState('todos', []);
                                                            const updated = todos.filter(t => t.id !== todo.id);
                                                            juris.setState('todos', updated);
                                                        }
                                                    }
                                                },
                                                
                                            ]
                                        }
                                    };
                                },
                                keyFn: 'id',
                                placeholder: {
                                    div: {
                                        class: 'smartlist-empty',
                                        text: '📝 No todos yet. Add some tasks above!'
                                    }
                                },
                                showDiffBadge: true,
                                onItemAdd: (item) => console.log('Todo added:', item.title),
                                onItemRemove: (item) => console.log('Todo removed:', item.title)
                            }
                        }
                                            ]
                                        }
                                    };
                                },
                                keyFn: 'id',
                                placeholder: {
                                    div: {
                                        class: 'smartlist-empty',
                                        text: '📝 No todos yet. Add some tasks above!'
                                    }
                                },
                                showDiffBadge: true,
                                onItemAdd: (item) => console.log('Todo added:', item.title),
                                onItemRemove: (item) => console.log('Todo removed:', item.title)
                            }
                        }
                    ]
                }
            };
        });

        // Product list component
        juris.registerComponent('ProductExample', (props, context) => {
            return {
                div: {
                    class: 'example-section',
                    children: [
                        { div: { class: 'example-title', text: '🛍️ Product Catalog' } },
                        
                        {
                            div: {
                                class: 'controls',
                                children: [
                                    {
                                        button: {
                                            class: 'btn',
                                            text: 'Load Products',
                                            onclick: () => juris.setState('products', sampleProducts)
                                        }
                                    },
                                    {
                                        button: {
                                            class: 'btn secondary',
                                            text: 'Toggle Stock',
                                            onclick: () => {
                                                const products = juris.getState('products', []);
                                                const updated = products.map(p => ({
                                                    ...p,
                                                    inStock: !p.inStock
                                                }));
                                                juris.setState('products', updated);
                                            }
                                        }
                                    },
                                    {
                                        button: {
                                            class: 'btn danger',
                                            text: 'Clear',
                                            onclick: () => juris.setState('products', [])
                                        }
                                    }
                                ]
                            }
                        },

                        {
                            SmartList: {
                                items: () => juris.getState('products', []),
                                renderItem: (product, index) => ({
                                    div: {
                                        class: 'product-card',
                                        style: { opacity: product.inStock ? 1 : 0.6 },
                                        children: [
                                            {
                                                div: {
                                                    class: 'product-image',
                                                    text: product.inStock ? '📦 In Stock' : '❌ Out of Stock'
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'product-info',
                                                    children: [
                                                        { div: { class: 'product-name', text: product.name } },
                                                        { div: { class: 'product-price', text: `$${product.price}` } },
                                                        { div: { text: product.category, style: { fontSize: '12px', color: '#666' } } }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }),
                                keyFn: 'id',
                                placeholder: {
                                    div: {
                                        class: 'smartlist-empty',
                                        text: '🛍️ No products loaded. Click "Load Products" above!'
                                    }
                                },
                                class: 'product-grid',
                                style: {
                                    display: 'grid',
                                    gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                    gap: '15px'
                                }
                            }
                        }
                    ]
                }
            };
        });

        // Messages component with async loading simulation
        juris.registerComponent('MessageExample', (props, context) => {
            const loadMessagesAsync = () => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve(sampleMessages);
                    }, 1500);
                });
            };

            return {
                div: {
                    class: 'example-section',
                    children: [
                        { div: { class: 'example-title', text: '💬 Messages (Async Loading)' } },
                        
                        {
                            div: {
                                class: 'controls',
                                children: [
                                    {
                                        button: {
                                            class: 'btn',
                                            text: 'Load Messages',
                                            onclick: () => {
                                                juris.setState('messages', loadMessagesAsync());
                                            }
                                        }
                                    },
                                    {
                                        button: {
                                            class: 'btn secondary',
                                            text: 'Mark All Read',
                                            onclick: () => {
                                                const messages = juris.getState('messages', []);
                                                if (Array.isArray(messages)) {
                                                    const updated = messages.map(m => ({ ...m, unread: false }));
                                                    juris.setState('messages', updated);
                                                }
                                            }
                                        }
                                    },
                                    {
                                        button: {
                                            class: 'btn danger',
                                            text: 'Clear',
                                            onclick: () => juris.setState('messages', [])
                                        }
                                    }
                                ]
                            }
                        },

                        {
                            SmartList: {
                                items: () => juris.getState('messages', []),
                                renderItem: (message, index) => ({
                                    div: {
                                        class: `message-item ${message.unread ? 'unread' : ''}`,
                                        children: [
                                            {
                                                div: {
                                                    class: 'message-header',
                                                    children: [
                                                        { span: { class: 'message-sender', text: message.sender } },
                                                        { span: { class: 'message-time', text: message.time } }
                                                    ]
                                                }
                                            },
                                            {
                                                div: {
                                                    class: 'message-content',
                                                    text: message.content
                                                }
                                            }
                                        ]
                                    }
                                }),
                                keyFn: 'id',
                                loading: {
                                    div: {
                                        class: 'smartlist-loading',
                                        text: '📨 Loading messages...'
                                    }
                                },
                                placeholder: {
                                    div: {
                                        class: 'smartlist-empty',
                                        text: '💬 No messages. Click "Load Messages" to simulate async loading!'
                                    }
                                },
                                error: (error) => ({
                                    div: {
                                        class: 'smartlist-error',
                                        text: `Failed to load messages: ${error.message}`
                                    }
                                })
                            }
                        }
                    ]
                }
            };
        });
        // Main layout
        juris.layout = {
            div: {
                class: 'container',
                children: [
                    {
                        div: {
                            class: 'header',
                            children: [
                                { h1: { text: 'SmartList Reusable Component' } },
                                { p: { text: 'Flexible, high-performance list component for Juris 0.91.0' } }
                            ]
                        }
                    },
                    {
                        div: {
                            class: 'examples-grid',
                            children: [
                                { TodoExample: {} },
                                { ProductExample: {} },
                                { MessageExample: {} }
                            ]
                        }
                    }
                ]
            }
        };

        // Render the application
        juris.render('#app');

        console.log('🎉 SmartList Examples loaded successfully!');
    </script>
</body>
</html>