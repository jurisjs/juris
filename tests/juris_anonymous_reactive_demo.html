<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juris Anonymous Reactive Functions Demo</title>
    <script src="../src/juris.0.9.0.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .demo-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .demo-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .demo-title {
            color: #2d3748;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .demo-subtitle {
            color: #718096;
            font-size: 1.2em;
        }

        .demo-section {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            background: #f7fafc;
        }

        .section-title {
            color: #2d3748;
            font-size: 1.4em;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #667eea;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9em;
        }

        input, select, button {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .output {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            padding: 15px;
            min-height: 60px;
            font-size: 16px;
            line-height: 1.6;
        }

        .performance-info {
            background: #f0fff4;
            border: 1px solid #9ae6b4;
            border-radius: 6px;
            padding: 10px;
            font-size: 12px;
            color: #2f855a;
            margin-top: 10px;
        }

        .user-card {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            margin: 10px 0;
        }

        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }

        .user-info h3 {
            margin: 0 0 5px 0;
            color: #2d3748;
        }

        .user-role {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .role-admin { background: #fed7d7; color: #c53030; }
        .role-user { background: #bee3f8; color: #2b77cb; }
        .role-guest { background: #e2e8f0; color: #4a5568; }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .metric-label {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
            margin-top: 5px;
        }

        .notification {
            padding: 10px 15px;
            border-radius: 6px;
            margin: 5px 0;
        }

        .notification.info { background: #bee3f8; color: #2b77cb; }
        .notification.warning { background: #faf089; color: #d69e2e; }
        .notification.error { background: #fed7d7; color: #c53030; }
        .notification.success { background: #c6f6d5; color: #2f855a; }

        .async-demo {
            border: 2px dashed #cbd5e0;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }

        .loading {
            color: #667eea;
            font-style: italic;
        }

        .error {
            color: #c53030;
            background: #fed7d7;
            padding: 10px;
            border-radius: 6px;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin: 5px 0;
        }

        .todo-item.completed {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .code-snippet {
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1 class="demo-title">Juris Anonymous Reactive Functions</h1>
            <p class="demo-subtitle">Ultra-granular reactivity with zero overhead</p>
        </div>

        <!-- Basic Reactivity Demo -->
        <div class="demo-section">
            <h2 class="section-title">1. Basic Mixed Content Reactivity</h2>
            <div class="controls">
                <div class="control-group">
                    <label for="userName">User Name:</label>
                    <input type="text" id="userName" placeholder="Enter your name">
                </div>
                <div class="control-group">
                    <label for="messageCount">Message Count:</label>
                    <input type="number" id="messageCount" value="0" min="0">
                </div>
            </div>
            <div id="basic-output" class="output"></div>
            <div class="performance-info">
                ⚡ Only the specific text nodes update - no component re-renders!
            </div>
            <div class="code-snippet">
children: [
  "Welcome, ",
  () => getState('user.name', 'Guest'),  // Updates only this text
  "! You have ",
  () => getState('user.messages', 0),    // Updates only this text  
  " messages."
]</div>
        </div>

        <!-- Conditional Rendering Demo -->
        <div class="demo-section">
            <h2 class="section-title">2. Conditional Rendering & User Roles</h2>
            <div class="controls">
                <div class="control-group">
                    <label for="userRole">User Role:</label>
                    <select id="userRole">
                        <option value="guest">Guest</option>
                        <option value="user">User</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="isOnline">Online Status:</label>
                    <select id="isOnline">
                        <option value="true">Online</option>
                        <option value="false">Offline</option>
                    </select>
                </div>
            </div>
            <div id="conditional-output" class="output"></div>
            <div class="code-snippet">
() => {
  const role = getState('user.role', 'guest');
  const online = getState('user.online', false);
  
  if (role === 'admin') {
    return { div: { className: 'admin-panel', children: [...] } };
  } else if (role === 'user') {
    return online ? userDashboard : offlineMessage;
  } else {
    return loginPrompt;
  }
}</div>
        </div>

        <!-- Real-time Dashboard Demo -->
        <div class="demo-section">
            <h2 class="section-title">3. Real-time Dashboard Metrics</h2>
            <div class="controls">
                <button id="startMetrics">Start Real-time Updates</button>
                <button id="stopMetrics">Stop Updates</button>
                <button id="resetMetrics">Reset Metrics</button>
            </div>
            <div id="dashboard-output" class="output"></div>
            <div class="performance-info">
                🔥 Each metric updates independently at different intervals
            </div>
        </div>

        <!-- Async Demo -->
        <div class="demo-section">
            <h2 class="section-title">4. Async Data Loading</h2>
            <div class="controls">
                <div class="control-group">
                    <label for="userId">User ID to Load:</label>
                    <input type="number" id="userId" value="1" min="1" max="10">
                </div>
                <button id="loadUser">Load User Data</button>
                <button id="simulateError">Simulate Error</button>
            </div>
            <div id="async-output" class="output"></div>
            <div class="code-snippet">
() => {
  const userId = getState('loadUserId');
  if (!userId) return 'Select a user to load';
  
  // Return Promise - automatic loading states!
  return fetchUserData(userId).then(user => ({
    div: { className: 'user-card', children: [...] }
  }));
}</div>
        </div>

        <!-- Dynamic Lists Demo -->
        <div class="demo-section">
            <h2 class="section-title">5. Dynamic Lists & Notifications</h2>
            <div class="controls">
                <button id="addNotification">Add Notification</button>
                <button id="clearNotifications">Clear All</button>
                <div class="control-group">
                    <label for="notificationType">Type:</label>
                    <select id="notificationType">
                        <option value="info">Info</option>
                        <option value="warning">Warning</option>
                        <option value="error">Error</option>
                        <option value="success">Success</option>
                    </select>
                </div>
            </div>
            <div id="notifications-output" class="output"></div>
        </div>

        <!-- Performance Comparison -->
        <div class="demo-section">
            <h2 class="section-title">6. Performance Comparison</h2>
            <div class="controls">
                <button id="benchmarkJuris">Benchmark Juris (1000 updates)</button>
                <button id="benchmarkTraditional">Benchmark Traditional (1000 updates)</button>
            </div>
            <div id="performance-output" class="output"></div>
        </div>
    </div>

    <script>
        // Initialize Juris
        const juris = new Juris({
            states: {
                user: {
                    name: 'Guest',
                    messages: 0,
                    role: 'guest',
                    online: true
                },
                dashboard: {
                    activeUsers: 142,
                    revenue: 12450,
                    orders: 89,
                    conversion: 3.2
                },
                notifications: {
                    items: [],
                    counter: 0
                },
                loadUserId: null,
                metricsRunning: false
            }
        });

        // 1. Basic Mixed Content Reactivity
        juris.registerComponent('BasicReactiveDemo', (props, context) => {
            return {
                div: {
                    style: { fontSize: '18px', lineHeight: '1.6' },
                    children: [
                        "Welcome, ",
                        () => {
                            const name = context.getState('user.name', 'Guest');
                            return {
                                span: {
                                    text: name,
                                    style: { 
                                        fontWeight: 'bold', 
                                        color: name === 'Guest' ? '#718096' : '#667eea' 
                                    }
                                }
                            };
                        },
                        "! You have ",
                        () => {
                            const count = context.getState('user.messages', 0);
                            return {
                                span: {
                                    text: count.toString(),
                                    style: { 
                                        fontWeight: 'bold',
                                        color: count > 0 ? '#c53030' : '#2f855a'
                                    }
                                }
                            };
                        },
                        "! You have ",
                        () => {
                            const count = context.getState('user.messages', 0);
                            return count === 1 ? ' message.' : ' messages.';
                        },
                    ]
                }
            };
        });

        // 2. Conditional Rendering Demo
        juris.registerComponent('ConditionalDemo', (props, context) => {
            return {
                div: {
                    children: [
                        () => {
                            const role = context.getState('user.role', 'guest');
                            const online = context.getState('user.online', true);
                            const name = context.getState('user.name', 'Guest');

                            if (role === 'admin') {
                                return {
                                    div: {
                                        className: 'user-card',
                                        children: [
                                            {
                                                div: {
                                                    className: 'avatar',
                                                    text: '👑'
                                                }
                                            },
                                            {
                                                div: {
                                                    className: 'user-info',
                                                    children: [
                                                        { h3: { text: `Administrator ${name}` }},
                                                        { 
                                                            span: { 
                                                                text: 'ADMIN', 
                                                                className: 'user-role role-admin' 
                                                            }
                                                        },
                                                        { p: { text: 'Full system access • Can manage all users' }}
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                };
                            } else if (role === 'user') {
                                return {
                                    div: {
                                        className: 'user-card',
                                        children: [
                                            {
                                                div: {
                                                    className: 'avatar',
                                                    text: online ? '🟢' : '⚫'
                                                }
                                            },
                                            {
                                                div: {
                                                    className: 'user-info',
                                                    children: [
                                                        { h3: { text: name }},
                                                        { 
                                                            span: { 
                                                                text: 'USER', 
                                                                className: 'user-role role-user' 
                                                            }
                                                        },
                                                        { 
                                                            p: { 
                                                                text: online ? 
                                                                    '✅ Online • Active user' : 
                                                                    '⚠️ Offline • Limited access'
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                };
                            } else {
                                return {
                                    div: {
                                        className: 'user-card',
                                        children: [
                                            {
                                                div: {
                                                    className: 'avatar',
                                                    text: '👤'
                                                }
                                            },
                                            {
                                                div: {
                                                    className: 'user-info',
                                                    children: [
                                                        { h3: { text: 'Guest User' }},
                                                        { 
                                                            span: { 
                                                                text: 'GUEST', 
                                                                className: 'user-role role-guest' 
                                                            }
                                                        },
                                                        { p: { text: '🔐 Please log in for full access' }}
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                };
                            }
                        }
                    ]
                }
            };
        });

        // 3. Real-time Dashboard Demo
        juris.registerComponent('DashboardDemo', (props, context) => {
            return {
                div: {
                    children: [
                        {
                            h3: {
                                text: 'Live Metrics Dashboard',
                                style: { marginBottom: '15px', color: '#2d3748' }
                            }
                        },
                        {
                            div: {
                                className: 'metrics-grid',
                                children: [
                                    () => {
                                        const users = context.getState('dashboard.activeUsers', 0);
                                        if(users <110){
                                            return;
                                        }
                                        return {
                                            div: {
                                                className: 'metric-card',
                                                children: [
                                                    {
                                                        div: {
                                                            className: 'metric-value',
                                                            text: users.toLocaleString()
                                                        }
                                                    },
                                                    {
                                                        div: {
                                                            className: 'metric-label',
                                                            text: 'Active Users'
                                                        }
                                                    }
                                                ]
                                            }
                                        };
                                    },
                                    ()=>context.getState('dashboard.revenue', 0),
                                    () => {
                                        const revenue = context.getState('dashboard.revenue', 0);
                                        if(revenue < 12000){
                                            return {
                                            div: {
                                                className: 'metric-value',
                                                text: `Below $11,000`
                                            }}
                                        }
                                        return {
                                            div: {
                                                className: 'metric-card',
                                                children: [
                                                    {
                                                        div: {
                                                            className: 'metric-value',
                                                            text: `$${revenue.toLocaleString()}`
                                                        }
                                                    },
                                                    {
                                                        div: {
                                                            className: 'metric-label',
                                                            text: 'Revenue'
                                                        }
                                                    }
                                                ]
                                            }
                                        };
                                    },
                                    () => {
                                        const orders = context.getState('dashboard.orders', 0);
                                        return {
                                            div: {
                                                className: 'metric-card',
                                                children: [
                                                    {
                                                        div: {
                                                            className: 'metric-value',
                                                            text: orders.toString()
                                                        }
                                                    },
                                                    {
                                                        div: {
                                                            className: 'metric-label',
                                                            text: 'Orders Today'
                                                        }
                                                    }
                                                ]
                                            }
                                        };
                                    },
                                    () => {
                                        const conversion = context.getState('dashboard.conversion', 0);
                                        return {
                                            div: {
                                                className: 'metric-card',
                                                children: [
                                                    {
                                                        div: {
                                                            className: 'metric-value',
                                                            text: `${conversion}%`
                                                        }
                                                    },
                                                    {
                                                        div: {
                                                            className: 'metric-label',
                                                            text: 'Conversion'
                                                        }
                                                    }
                                                ]
                                            }
                                        };
                                    }
                                ]
                            }
                        }
                    ]
                }
            };
        });

        // 4. Async Demo
        const mockUsers = [
            { id: 1, name: 'Alice Johnson', email: 'alice@example.com', role: 'admin', avatar: '👩‍💼' },
            { id: 2, name: 'Bob Smith', email: 'bob@example.com', role: 'user', avatar: '👨‍💻' },
            { id: 3, name: 'Carol Davis', email: 'carol@example.com', role: 'user', avatar: '👩‍🎨' },
            { id: 4, name: 'David Wilson', email: 'david@example.com', role: 'user', avatar: '👨‍🔬' },
            { id: 5, name: 'Eva Brown', email: 'eva@example.com', role: 'admin', avatar: '👩‍🚀' }
        ];

        const fetchUserData = (userId) => {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    const user = mockUsers.find(u => u.id === userId);
                    if (user) {
                        resolve(user);
                    } else {
                        reject(new Error(`User ${userId} not found`));
                    }
                }, Math.random() * 2000 + 500); // 500ms to 2.5s delay
            });
        };

        juris.registerComponent('AsyncDemo', (props, context) => {
            return {
                div: {
                    children: [
                        () => {
                            const userId = context.getState('loadUserId', null);
                            const shouldError = context.getState('simulateError', false);
                            
                            if (!userId) {
                                return {
                                    div: {
                                        className: 'async-demo',
                                        text: '👆 Enter a User ID and click "Load User Data" to see async reactive functions in action'
                                    }
                                };
                            }

                            if (shouldError) {
                                return Promise.reject(new Error('Simulated network error'));
                            }

                            return fetchUserData(userId).then(user => {
                                return {
                                    div: {
                                        className: 'user-card',
                                        children: [
                                            {
                                                div: {
                                                    className: 'avatar',
                                                    text: user.avatar
                                                }
                                            },
                                            {
                                                div: {
                                                    className: 'user-info',
                                                    children: [
                                                        { h3: { text: user.name }},
                                                        { p: { text: user.email }},
                                                        { 
                                                            span: { 
                                                                text: user.role.toUpperCase(), 
                                                                className: `user-role role-${user.role}` 
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                };
                            });
                        }
                    ]
                }
            };
        });

        // 5. Dynamic Lists Demo
        juris.registerComponent('NotificationsDemo', (props, context) => {
            return {
                div: {
                    children: [
                        () => {
                            const notifications = context.getState('notifications.items', []);
                            
                            if (notifications.length === 0) {
                                return {
                                    div: {
                                        className: 'async-demo',
                                        text: '📭 No notifications yet. Click "Add Notification" to see reactive lists in action!'
                                    }
                                };
                            }

                            return {
                                div: {
                                    children: notifications.map(notification => ({
                                        div: {
                                            key: notification.id,
                                            className: `notification ${notification.type}`,
                                            children: [
                                                `${notification.icon} ${notification.message}`,
                                                {
                                                    span: {
                                                        text: ` (${new Date(notification.time).toLocaleTimeString()})`,
                                                        style: { fontSize: '12px', opacity: 0.7 }
                                                    }
                                                }
                                            ]
                                        }
                                    }))
                                }
                            };
                        }
                    ]
                }
            };
        });

        // Render components
        const basicOutput = document.getElementById('basic-output');
        const conditionalOutput = document.getElementById('conditional-output');
        const dashboardOutput = document.getElementById('dashboard-output');
        const asyncOutput = document.getElementById('async-output');
        const notificationsOutput = document.getElementById('notifications-output');
        const performanceOutput = document.getElementById('performance-output');

        basicOutput.appendChild(juris.domRenderer.render({ BasicReactiveDemo: {} }));
        conditionalOutput.appendChild(juris.domRenderer.render({ ConditionalDemo: {} }));
        dashboardOutput.appendChild(juris.domRenderer.render({ DashboardDemo: {} }));
        asyncOutput.appendChild(juris.domRenderer.render({ AsyncDemo: {} }));
        notificationsOutput.appendChild(juris.domRenderer.render({ NotificationsDemo: {} }));

        // Event listeners
        document.getElementById('userName').addEventListener('input', (e) => {
            juris.setState('user.name', e.target.value || 'Guest');
        });

        document.getElementById('messageCount').addEventListener('input', (e) => {
            juris.setState('user.messages', parseInt(e.target.value) || 0);
        });

        document.getElementById('userRole').addEventListener('change', (e) => {
            juris.setState('user.role', e.target.value);
        });

        document.getElementById('isOnline').addEventListener('change', (e) => {
            juris.setState('user.online', e.target.value === 'true');
        });

        // Real-time metrics
        let metricsInterval;
        
        document.getElementById('startMetrics').addEventListener('click', () => {
            juris.setState('metricsRunning', true);
            
            metricsInterval = setInterval(() => {
                juris.executeBatch(() => {
                    juris.setState('dashboard.activeUsers', 
                        Math.floor(Math.random() * 50) + 100);
                    juris.setState('dashboard.revenue', 
                        Math.floor(Math.random() * 5000) + 10000);
                    juris.setState('dashboard.orders', 
                        Math.floor(Math.random() * 20) + 70);
                    juris.setState('dashboard.conversion', 
                        (Math.random() * 3 + 2).toFixed(1));
                });
            }, 1000);
        });

        document.getElementById('stopMetrics').addEventListener('click', () => {
            juris.setState('metricsRunning', false);
            clearInterval(metricsInterval);
        });

        document.getElementById('resetMetrics').addEventListener('click', () => {
            clearInterval(metricsInterval);
            juris.executeBatch(() => {
                juris.setState('dashboard.activeUsers', 142);
                juris.setState('dashboard.revenue', 12450);
                juris.setState('dashboard.orders', 89);
                juris.setState('dashboard.conversion', 3.2);
                juris.setState('metricsRunning', false);
            });
        });

        // Async demo
        document.getElementById('loadUser').addEventListener('click', () => {
            const userId = parseInt(document.getElementById('userId').value) || 1;
            juris.setState('simulateError', false);
            juris.setState('loadUserId', userId);
        });

        document.getElementById('simulateError').addEventListener('click', () => {
            juris.setState('simulateError', true);
            juris.setState('loadUserId', 999); // Non-existent user
        });

        // Notifications
        const notificationMessages = {
            info: ['New message received', 'System update available', 'Welcome to the platform'],
            warning: ['Low disk space', 'Session expires soon', 'Unstable connection'],
            error: ['Failed to save', 'Network error', 'Authentication failed'],
            success: ['Data saved successfully', 'Profile updated', 'Task completed']
        };

        const notificationIcons = {
            info: '💬',
            warning: '⚠️',
            error: '❌',
            success: '✅'
        };

        document.getElementById('addNotification').addEventListener('click', () => {
            const type = document.getElementById('notificationType').value;
            const messages = notificationMessages[type];
            const message = messages[Math.floor(Math.random() * messages.length)];
            
            const notifications = juris.getState('notifications.items', []);
            const newNotification = {
                id: Date.now(),
                type,
                message,
                icon: notificationIcons[type],
                time: Date.now()
            };
            
            juris.setState('notifications.items', [...notifications, newNotification]);
        });

        document.getElementById('clearNotifications').addEventListener('click', () => {
            juris.setState('notifications.items', []);
        });

        // Performance benchmark
        document.getElementById('benchmarkJuris').addEventListener('click', () => {
            const start = performance.now();
            
            // Simulate 1000 rapid updates
            for (let i = 0; i < 1000; i++) {
                juris.setState('user.messages', i);
            }
            
            const end = performance.now();
            const duration = (end - start).toFixed(2);
            
            // Note: Each state change triggers 2 reactive functions (count + singular/plural text)
            const stateChanges = 1000;
            const domUpdates = 2000; // 2 reactive functions per state change
            
            performanceOutput.innerHTML = `
                <h4>🚀 Juris Performance (1000 state changes → 2000 DOM updates)</h4>
                <p><strong>Total time:</strong> ${duration}ms</p>
                <p><strong>State changes:</strong> ${stateChanges.toLocaleString()}</p>
                <p><strong>DOM updates:</strong> ${domUpdates.toLocaleString()}</p>
                <p><strong>Average per state change:</strong> ${(parseFloat(duration) / stateChanges).toFixed(3)}ms</p>
                <p><strong>Average per DOM update:</strong> ${(parseFloat(duration) / domUpdates).toFixed(3)}ms</p>
                <p><strong>DOM updates per second:</strong> ${Math.round(domUpdates / parseFloat(duration) * 1000).toLocaleString()}</p>
                <div class="performance-info">
                    ⚡ Ultra-fast direct DOM updates with surgical precision! Each state change efficiently triggers multiple reactive functions.
                </div>
            `;
        });

        document.getElementById('benchmarkTraditional').addEventListener('click', () => {
            const start = performance.now();
            
            // Simulate traditional framework overhead
            const element = document.createElement('div');
            for (let i = 0; i < 1000; i++) {
                // Simulate virtual DOM creation + diffing + reconciliation
                const vdom = { type: 'span', props: { children: `Messages: ${i}` } };
                const html = `<span>Messages: ${i}</span><span>${i === 1 ? ' message.' : ' messages.'}</span>`;
                element.innerHTML = html; // Simulate full re-render of both elements
            }
            
            const end = performance.now();
            const duration = (end - start).toFixed(2);
            
            // Traditional frameworks would re-render entire components
            const stateChanges = 1000;
            const componentRenders = 1000; // Full component re-renders
            
            performanceOutput.innerHTML = `
                <h4>🐌 Traditional Framework Simulation (1000 state changes → 1000 component re-renders)</h4>
                <p><strong>Total time:</strong> ${duration}ms</p>
                <p><strong>State changes:</strong> ${stateChanges.toLocaleString()}</p>
                <p><strong>Component re-renders:</strong> ${componentRenders.toLocaleString()}</p>
                <p><strong>Average per state change:</strong> ${(parseFloat(duration) / stateChanges).toFixed(3)}ms</p>
                <p><strong>Average per component render:</strong> ${(parseFloat(duration) / componentRenders).toFixed(3)}ms</p>
                <p><strong>Component renders per second:</strong> ${Math.round(componentRenders / parseFloat(duration) * 1000).toLocaleString()}</p>
                <div class="performance-info" style="background: #fff5f5; border-color: #fed7d7; color: #c53030;">
                    🔄 Full component re-renders with virtual DOM overhead vs surgical DOM node updates
                </div>
            `;
        });

        console.log('🚀 Juris Anonymous Reactive Functions Demo loaded!');
        console.log('Framework instance:', juris);
        console.log('Try changing values and watch the surgical updates!');
    </script>
</body>
</html>