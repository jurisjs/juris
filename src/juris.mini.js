"use strict";const jurisLinesOfCode=2907,jurisVersion="0.9.0",jurisMinifiedSize="54 kB",isValidPath=e=>"string"==typeof e&&e.trim().length>0&&!e.includes(".."),getPathParts=e=>e.split(".").filter(Boolean),deepEquals=(e,t)=>{if(e===t)return!0;if(null==e||null==t||typeof e!=typeof t)return!1;if("object"==typeof e){if(Array.isArray(e)!==Array.isArray(t))return!1;const n=Object.keys(e),s=Object.keys(t);return n.length===s.length&&n.every((n=>s.includes(n)&&deepEquals(e[n],t[n])))}return!1},createLogger=()=>{const e=[],t=(t,n,s)=>{const r={formatted:`${s?`[${s}] `:""}${t}${n?` ${JSON.stringify(n)}`:""}`,message:t,context:n,category:s,timestamp:Date.now()};return setTimeout((()=>e.forEach((e=>e(r)))),0),r};return{log:{l:t,w:t,e:t,i:t,d:t,ei:!0,ee:!0,el:!0,ew:!0,ed:!0},sub:t=>e.push(t),unsub:t=>e.splice(e.indexOf(t),1)}},{log:log,sub:logSub,unsub:logUnsub}=createLogger(),createPromisify=()=>{const e=new Set;let t=!1;const n=new Set,s=()=>{0===e.size&&n.size>0&&n.forEach((e=>e()))};return{promisify:n=>{const r="function"==typeof n?.then?n:Promise.resolve(n);return t&&r!==n&&(e.add(r),r.finally((()=>{e.delete(r),setTimeout(s,0)}))),r},startTracking:()=>{t=!0,e.clear()},stopTracking:()=>{t=!1,n.clear()},onAllComplete:t=>(n.add(t),0===e.size&&setTimeout(t,0),()=>n.delete(t))}},{promisify:promisify,startTracking:startTracking,stopTracking:stopTracking,onAllComplete:onAllComplete}=createPromisify();class StateManager{constructor(e={},t=[]){this.state={...e},this.middleware=[...t],this.subscribers=new Map,this.externalSubscribers=new Map,this.currentTracking=null,this.isUpdating=!1,this.initialState=JSON.parse(JSON.stringify(e)),this.maxUpdateDepth=50,this.updateDepth=0,this.currentlyUpdating=new Set,this.isBatching=!1,this.batchQueue=[],this.batchedPaths=new Set}track(e,t=!1){const n=this.currentTracking,s=t?null:this.currentTracking=new Set;let r;try{return r=e(),r?.then?r.then((e=>({result:e,deps:s?[...s]:[]}))):{result:r,deps:s?[...s]:[]}}finally{r?.then?r.finally((()=>this.currentTracking=n)):this.currentTracking=n}}reset(){this.isBatching&&(this.batchQueue=[],this.batchedPaths.clear(),this.isBatching=!1),this.state=JSON.parse(JSON.stringify(this.initialState))}getState(e,t=null,n=!0){if(!isValidPath(e))return t;n&&this.currentTracking?.add(e);const s=getPathParts(e);let r=this.state;for(const e of s){if(void 0===r?.[e])return t;r=r[e]}return r}setState(e,t,n={}){log.ed&&console.debug(log.d("State change initiated",{path:e,hasValue:void 0!==t},"application")),isValidPath(e)&&!this.#e(e)&&(this.isBatching?this.#t(e,t,n):this.#n(e,t,n))}executeBatch(e){if(this.isBatching)return e();this.#s();try{const t=e();return t&&"function"==typeof t.then?t.then((e=>(this.#r(),e))).catch((e=>{throw this.#r(),e})):(this.#r(),t)}catch(e){throw this.#r(),e}}#s(){this.isBatching=!0,this.batchQueue=[],this.batchedPaths.clear()}#r(){this.isBatching?(this.isBatching=!1,0!==this.batchQueue.length&&this.#o()):log.ew&&console.warn(log.w("endBatch() called without beginBatch()",{},"framework"))}isBatchingActive(){return this.isBatching}getBatchQueueSize(){return this.batchQueue.length}clearBatch(){this.isBatching&&(this.batchQueue=[],this.batchedPaths.clear())}#t(e,t,n){this.batchQueue=this.batchQueue.filter((t=>t.path!==e)),this.batchQueue.push({path:e,value:t,context:n,timestamp:Date.now()}),this.batchedPaths.add(e)}#o(){const e=[...this.batchQueue];this.batchQueue=[],this.batchedPaths.clear();const t=new Map;e.forEach((e=>t.set(e.path,e)));const n=this.isUpdating;this.isUpdating=!0;const s=[];t.forEach((e=>{const t=this.getState(e.path);let n=e.value;for(const s of this.middleware)try{const r=s({path:e.path,oldValue:t,newValue:n,context:e.context,state:this.state});void 0!==r&&(n=r)}catch(t){log.ee&&console.error(log.e("Middleware error in batch",{path:e.path,error:t.message},"application"))}if(deepEquals(t,n))return;const r=getPathParts(e.path);let o=this.state;for(let e=0;e<r.length-1;e++){const t=r[e];null!=o[t]&&"object"==typeof o[t]||(o[t]={}),o=o[t]}o[r[r.length-1]]=n,s.push({path:e.path,oldValue:t,newValue:n})})),this.isUpdating=n;const r=new Set;s.forEach((({path:e})=>{const t=getPathParts(e);for(let e=1;e<=t.length;e++)r.add(t.slice(0,e).join("."))})),r.forEach((e=>{this.subscribers.has(e)&&this.#a(e),this.externalSubscribers.has(e)&&this.externalSubscribers.get(e).forEach((({callback:t,hierarchical:n})=>{try{t(this.getState(e),null,e)}catch(e){log.ee&&console.error(log.e("External subscriber error:",e),"application")}}))}))}#n(e,t,n={}){const s=this.getState(e);let r=t;for(const t of this.middleware)try{const o=t({path:e,oldValue:s,newValue:r,context:n,state:this.state});void 0!==o&&(r=o)}catch(n){log.ee&&console.error(log.e("Middleware error",{path:e,error:n.message,middlewareName:t.name||"anonymous"},"application"))}if(deepEquals(s,r))return void(log.ed&&console.debug(log.d("State unchanged, skipping update",{path:e},"framework")));const o=getPathParts(e);let a=this.state;for(let e=0;e<o.length-1;e++){const t=o[e];null!=a[t]&&"object"==typeof a[t]||(a[t]={}),a=a[t]}a[o[o.length-1]]=r,this.isUpdating||(this.isUpdating=!0,this.currentlyUpdating||(this.currentlyUpdating=new Set),this.currentlyUpdating.add(e),this.#i(e,r,s),this.#c(e,r,s),this.currentlyUpdating.delete(e),this.isUpdating=!1)}subscribe(e,t,n=!0){this.externalSubscribers.has(e)||this.externalSubscribers.set(e,new Set);const s={callback:t,hierarchical:n};return this.externalSubscribers.get(e).add(s),()=>{const t=this.externalSubscribers.get(e);t&&(t.delete(s),0===t.size&&this.externalSubscribers.delete(e))}}subscribeExact(e,t){return this.subscribe(e,t,!1)}subscribeInternal(e,t){return this.subscribers.has(e)||this.subscribers.set(e,new Set),this.subscribers.get(e).add(t),()=>{const n=this.subscribers.get(e);n&&(n.delete(t),0===n.size&&this.subscribers.delete(e))}}#i(e,t,n){this.#a(e);const s=getPathParts(e);for(let e=s.length-1;e>0;e--)this.#a(s.slice(0,e).join("."));const r=e?e+".":"";new Set([...this.subscribers.keys(),...this.externalSubscribers.keys()]).forEach((t=>{t.startsWith(r)&&t!==e&&this.#a(t)}))}#c(e,t,n){this.externalSubscribers.forEach(((s,r)=>{s.forEach((({callback:s,hierarchical:o})=>{if(o?e===r||e.startsWith(r+"."):e===r)try{s(t,n,e)}catch(e){log.ee&&console.error(log.e("External subscriber error:",e),"application")}}))}))}#a(e){const t=this.subscribers.get(e);t&&t.size>0&&(log.ed&&console.debug(log.d("Triggering subscribers",{path:e,subscriberCount:t.size},"framework")),new Set(t).forEach((e=>{try{const{deps:t}=this.track((()=>e()));t.forEach((t=>{const n=this.subscribers.get(t);n&&n.has(e)||this.subscribeInternal(t,e)}))}catch(e){log.ee&&console.error(log.e("Subscriber error:",e),"application")}})))}#e(e){return this.currentlyUpdating||(this.currentlyUpdating=new Set),!!this.currentlyUpdating.has(e)&&(log.ew&&console.warn(log.w("Circular dependency detected",{path:e},"framework")),!0)}startTracking(){const e=new Set;return this.currentTracking=e,e}endTracking(){const e=this.currentTracking;return this.currentTracking=null,e||new Set}}class ComponentManager{constructor(e){this.juris=e,this.components=new Map,this.instances=new Map,this.namedComponents=new Map,this.componentCounters=new Map,this.componentStates=new Map,this.asyncPlaceholders=new Map,this.asyncPropsCache=new Map}register(e,t){this.components.set(e,t)}create(e,t={}){const n=this.components.get(e);if(!n)return log.ee&&console.error(log.e("Component not found",{name:e},"application")),null;try{if(this.juris.domRenderer._hasAsyncProps(t))return this.#l(e,n,t);const{componentId:s,componentStates:r,context:o}=this.#h(e),a=n(t,o);return a?.then?this.#d(promisify(a),e,t,r):this.#p(a,e,t,r)}catch(t){return log.ee&&console.error(log.e("Component creation failed!",{name:e,error:t.message},"application")),this.#u(e,t)}}#h(e){const{componentId:t,componentStates:n}=this.#m(e);return{componentId:t,componentStates:n,context:this.#g(t,n)}}#m(e){this.componentCounters.has(e)||this.componentCounters.set(e,0);const t=this.componentCounters.get(e)+1;this.componentCounters.set(e,t);return{componentId:`${e}#${t}`,componentStates:new Set}}#g(e,t){const n=this.juris.createContext();return n.newState=(n,s)=>{const r=`##local.${e}.${n}`;return this.juris.stateManager.getState(r,Symbol("not-found"))===Symbol("not-found")&&this.juris.stateManager.setState(r,s),t.add(r),[()=>this.juris.stateManager.getState(r,s),e=>this.juris.stateManager.setState(r,e)]},n}#l(e,t,n){const s=this.#f(e,"async-props-loading");return this.asyncPlaceholders.set(s,{name:e,props:n,type:"async-props"}),this.#y(n).then((n=>{try{const r=this.#C(e,t,n);this.#b(s,r)}catch(e){this.#E(s,e)}})).catch((e=>this.#E(s,e))),s}async#y(e){const t=this.#S(e),n=this.asyncPropsCache.get(t);if(n&&Date.now()-n.timestamp<5e3)return n.props;const s={};for(const[t,n]of Object.entries(e))if(n?.then)try{s[t]=await n}catch(e){s[t]={__asyncError:e.message}}else s[t]=n;return this.asyncPropsCache.set(t,{props:s,timestamp:Date.now()}),s}#C(e,t,n){const{componentId:s,componentStates:r,context:o}=this.#h(e),a=t(n,o);return a?.then?this.#d(promisify(a),e,n,r):this.#p(a,e,n,r)}#d(e,t,n,s){const r=this.#f(t,"async-loading");return this.asyncPlaceholders.set(r,{name:t,props:n,componentStates:s}),e.then((e=>{try{const o=this.#p(e,t,n,s);this.#b(r,o)}catch(e){log.ee&&console.error(log.e("Async component failed",{name:t,error:e.message},"application")),this.#E(r,e)}})).catch((e=>this.#E(r,e))),r}#p(e,t,n,s){if(Array.isArray(e))return this.#v(e,t,n,s);if(e&&"object"==typeof e){if(this.#x(e))return this.#T(e,t,n,s);if("function"==typeof e.render&&!this.#x(e))return this.#w(e,t,n,s);const r=Object.keys(e);if(1===r.length&&"string"==typeof r[0]&&r[0].length>0){const n=this.juris.domRenderer.render(e,!1,t);return n&&s.size>0&&this.componentStates.set(n,s),n}}const r=this.juris.domRenderer.render(e);return r&&s.size>0&&this.componentStates.set(r,s),r}#v(e,t,n,s){const r=document.createDocumentFragment(),o=this.#M(r,t,n),a=[];return this.juris.domRenderer._handleChildren(o,e,a),r._jurisComponent={name:t,props:n,virtual:o,cleanup:()=>{a.forEach((e=>{try{e()}catch(e){}}))}},s?.size>0&&(r._jurisComponentStates=s),r}#T(e,t,n,s){const r=this.#P(e,t,n),o=r.render?r.render():e;if(o?.then)return this.#k(promisify(o),r,s);const a=this.juris.domRenderer.render(o,!1,t);return a&&this.#A(a,r,s,t),a}#w(e,t,n,s){const r=document.createElement("div");r.setAttribute("data-juris-reactive-render",t);const o={name:t,api:e.api||{},render:e.render};this.instances.set(r,o),e.api&&this.namedComponents.set(t,{element:r,instance:o});const a=[];return this.juris.domRenderer._createReactiveUpdate(r,(()=>this.#j(e.render,r,t)),a),a.length>0&&this.juris.domRenderer.subscriptions.set(r,{subscriptions:a,eventListeners:[]}),s?.size>0&&this.componentStates.set(r,s),r}#P(e,t,n){return{name:t,props:n,hooks:e.hooks||{onMount:e.onMount,onUpdate:e.onUpdate,onUnmount:e.onUnmount},api:e.api||{},render:e.render}}#A(e,t,n,s){this.instances.set(e,t),n?.size>0&&this.componentStates.set(e,n),t.api&&Object.keys(t.api).length>0&&this.namedComponents.set(s,{element:e,instance:t}),t.hooks.onMount&&setTimeout((()=>this.#R(t.hooks.onMount,e,s,"onMount")),0)}#k(e,t,n){const s=this.#f(t.name,"async-lifecycle");return e.then((e=>{try{const r=this.juris.domRenderer.render(e);r&&(this.#A(r,t,n,t.name),this.#b(s,r))}catch(e){this.#E(s,e)}})).catch((e=>this.#E(s,e))),s}updateInstance(e,t){const n=this.instances.get(e);if(!n)return;const s=n.props;deepEquals(s,t)||(this.juris.domRenderer._hasAsyncProps(t)?this.#y(t).then((t=>{n.props=t,this.#L(n,e,s,t)})).catch((e=>{log.ee&&console.error(log.e(`Error updating async props for ${n.name}:`,e),"application")})):(n.props=t,this.#L(n,e,s,t)))}#L(e,t,n,s){e.hooks.onUpdate&&this.#R(e.hooks.onUpdate,[n,s],e.name,"onUpdate");try{const n=e.render(),s=promisify(n);s!==n?s.then((e=>{this.juris.domRenderer.updateElementContent(t,e)})).catch((t=>{log.ee&&console.error(log.e(`Async re-render error in ${e.name}:`,t),"application")})):this.juris.domRenderer.updateElementContent(t,n)}catch(t){log.ee&&console.error(log.e(`Re-render error in ${e.name}:`,t),"application")}}#j(e,t,n){try{const s=e();if(s?.then)return t.innerHTML='<div class="juris-loading">Loading...</div>',void promisify(s).then((e=>{t.innerHTML="";const n=this.juris.domRenderer.render(e);n&&t.appendChild(n)})).catch((e=>{log.ee&&console.error(`Async render error for ${n}:`,e),t.innerHTML=`<div class="juris-error">Render Error: ${e.message}</div>`}));Array.from(t.children).forEach((e=>this.cleanup(e))),t.innerHTML="";const r=this.juris.domRenderer.render(s);r&&t.appendChild(r)}catch(e){log.ee&&console.error(`Error in reactive render for ${n}:`,e),t.innerHTML=`<div class="juris-error">Render Error: ${e.message}</div>`}}#R(e,t,n,s){try{const r=Array.isArray(t)?e(...t):e(t);r?.then&&promisify(r).catch((e=>log.ee&&console.error(log.e(`Async ${s} error in ${n}:`,e),"application")))}catch(e){log.ee&&console.error(log.e(`${s} error in ${n}:`,e),"application")}}#M(e,t,n){const s={_isVirtual:!0,_fragment:e,_componentName:t,_componentProps:n,appendChild:t=>e.appendChild(t),removeChild:t=>{t.parentNode===e&&e.removeChild(t)},replaceChild:(t,n)=>{n.parentNode===e&&e.replaceChild(t,n)},get children(){return Array.from(e.childNodes)},get parentNode(){return null},textContent:""};return Object.defineProperty(s,"textContent",{set(t){for(;e.firstChild;)e.removeChild(e.firstChild);t&&e.appendChild(document.createTextNode(t))},get:()=>""}),s}#f(e,t){const n=document.createElement("div");return n.id=e.toLowerCase().replace(/[^a-z0-9]/g,"-"),this._createPlaceholder(`Loading ${e}...`,t,n)}#b(e,t){t&&e.parentNode&&e.parentNode.replaceChild(t,e),this.asyncPlaceholders.delete(e)}#E(e,t){const n=this.#u(e._jurisComponent?.name||"Unknown Component",t);e.parentNode&&e.parentNode.replaceChild(n,e),this.asyncPlaceholders.delete(e)}#u(e,t){const n=document.createElement("div");return n.style.cssText="color: red; border: 1px solid red; padding: 8px; background: #ffe6e6; font-family: monospace;",n.textContent=`Component Error in ${e}: ${t.message}`,n}#x(e){return e.hooks&&(e.hooks.onMount||e.hooks.onUpdate||e.hooks.onUnmount)||e.onMount||e.onUpdate||e.onUnmount}#S(e){return JSON.stringify(e,((e,t)=>t?.then?"[Promise]":t))}cleanup(e){if(e instanceof DocumentFragment)return void this.#N(e);const t=this.instances.get(e);t?.hooks?.onUnmount&&this.#R(t.hooks.onUnmount,e,t.name,"onUnmount"),e._reactiveSubscriptions&&(e._reactiveSubscriptions.forEach((e=>{try{e()}catch(e){log.ew&&console.warn("Error cleaning up reactive subscription:",e)}})),e._reactiveSubscriptions=[]),this.#_(e),this.asyncPlaceholders.has(e)&&this.asyncPlaceholders.delete(e),this.instances.delete(e)}#N(e){e._jurisComponent?.cleanup&&e._jurisComponent.cleanup(),e._jurisComponentStates&&this.#I(e._jurisComponentStates)}#_(e){const t=this.componentStates.get(e);t&&(this.#I(t),this.componentStates.delete(e))}#I(e){e.forEach((e=>{const t=e.split(".");let n=this.juris.stateManager.state;for(let e=0;e<t.length-1;e++){if(!n[t[e]])return;n=n[t[e]]}delete n[t[t.length-1]]}))}getComponent(e){return this.namedComponents.get(e)?.instance||null}getComponentAPI(e){return this.namedComponents.get(e)?.instance?.api||null}getComponentElement(e){return this.namedComponents.get(e)?.element||null}getNamedComponents(){return Array.from(this.namedComponents.keys())}clearAsyncPropsCache(){this.asyncPropsCache.clear()}getAsyncStats(){return{registeredComponents:this.components.size,cachedAsyncProps:this.asyncPropsCache.size}}_createPlaceholder(e,t,n=null){const s=this.juris.domRenderer._getPlaceholderConfig(n),r=document.createElement("div");return r.className=s.className,r.textContent=s.text,s.style&&(r.style.cssText=s.style),r}}class DOMRenderer{constructor(e){this.juris=e,this.subscriptions=new Map,this.componentStack=[],this.objectTreeAnalyzer=null,this.eventMap={ondoubleclick:"dblclick",onmousedown:"mousedown",onmouseup:"mouseup",onmouseover:"mouseover",onmouseout:"mouseout",onmousemove:"mousemove",onkeydown:"keydown",onkeyup:"keyup",onkeypress:"keypress",onfocus:"focus",onblur:"blur",onchange:"change",oninput:"input",onsubmit:"submit",onload:"load",onresize:"resize",onscroll:"scroll"},this.BOOLEAN_ATTRS=new Set(["disabled","checked","selected","readonly","multiple","autofocus","autoplay","controls","hidden","loop","open","required","reversed","itemscope"]),this.PRESERVED_ATTRIBUTES=new Set(["viewBox","preserveAspectRatio","textLength","gradientUnits","gradientTransform","spreadMethod","patternUnits","patternContentUnits","patternTransform","clipPath","crossOrigin","xmlns","xmlns:xlink","xlink:href"]),this.SVG_ELEMENTS=new Set(["svg","g","defs","desc","metadata","title","circle","ellipse","line","polygon","polyline","rect","path","text","tspan","textPath","marker","pattern","clipPath","mask","image","switch","foreignObject","linearGradient","radialGradient","stop","animate","animateMotion","animateTransform","set","use","symbol"]),this.SKIP_ATTRS=new Set(["children","key"]),this.asyncPlaceholders=new Map,this.placeholderConfigs=new Map,this.defaultPlaceholder={className:"juris-async-loading",style:"padding: 8px; background: #f0f0f0; border: 1px dashed #ccc; opacity: 0.7;",text:"Loading...",children:null},this.TOUCH_CONFIG={moveThreshold:10,timeThreshold:300,touchAction:"manipulation",tapHighlight:"transparent",touchCallout:"none"},this.cleanupTimeout=null,new MutationObserver((()=>{this.cleanupTimeout&&clearTimeout(this.cleanupTimeout),this.cleanupTimeout=setTimeout((()=>{this.subscriptions.forEach(((e,t)=>{t.isConnected||this.cleanup(t)}))}),100)})).observe(document.body,{childList:!0,subtree:!0}),this._testMode=!1,this._lastObjectTree=null}attachObjectTreeAnalyzer(e){return this.objectTreeAnalyzer=e,this.objectTreeAnalyzer}setTestMode(e=!0){return this._testMode=e,this._testMode}isTestMode(){return this._testMode}getObjectTree(){return this.objectTreeAnalyzer?.getObjectTree()||null}render(e,t=null,n=!1){return this._testMode&&n&&this.objectTreeAnalyzer?this.objectTreeAnalyzer.buildObjectTree(e,t):this._renderToDOM(e,t)}_renderToDOM(e,t=null){if("string"==typeof e||"number"==typeof e)return document.createTextNode(String(e));if(!e||"object"!=typeof e)return null;if(Array.isArray(e))return this.#U(e,t);const n=Object.keys(e)[0],s=e[n]||{};if(this.componentStack.includes(n))return this.#u("recursion",[...this.componentStack,n].join(" → "));if(this.juris.componentManager.components.has(n))return this.#H(n,s);if(/^[A-Z]/.test(n))return this.#u("component",`Component "${n}" not registered`);if("string"!=typeof n||0===n.length)return null;let r=s;if(s.style&&this.customCSSExtractor){const e=t||n;r=this.customCSSExtractor.processProps(s,e,this)}return this.#O(n,r,t)}#O(e,t,n=null){const s=this.#$(e),r=[];for(const e in t){if(!t.hasOwnProperty(e)||"key"===e)continue;const o=this.applyProp(s,e,t[e],n);o&&"function"==typeof o&&r.push(o)}const o=this.subscriptions.get(s);return o&&r.length>0?o.subscriptions.push(...r):r.length>0&&this.subscriptions.set(s,{subscriptions:r,eventListeners:[]}),s}#B(e,t,n,s={}){let r=s.trackChanges?null:void 0,o=!1;return()=>{try{const e=t();this.#z(e)?promisify(e).then((e=>{s.trackChanges&&o&&deepEquals(e,r)||(n(e),s.trackChanges&&(r=e,o=!0))})).catch((e=>{s.onError?s.onError(e):log.ee&&console.error(log.e(`Error in async reactive ${s.name}:`,e),"application")})):s.trackChanges&&o&&deepEquals(e,r)||(n(e),s.trackChanges&&(r=e,o=!0))}catch(e){s.onError?s.onError(e):log.ee&&console.error(log.e(`Error in reactive ${s.name}:`,e),"application")}}}applyProp(e,t,n,s=null){const r=[],o=[];if("children"===t?this._handleChildren(e,n,r,s):"text"===t?this._handleText(e,n,r):"style"===t?this._handleStyle(e,n,r):t.startsWith("on")?this._handleEvent(e,t,n,o):"function"==typeof n?this._handleReactiveAttribute(e,t,n,r):this.#z(n)?"innerHTML"===t?this.#F(e,t,n,{setLoading:(e,t)=>e.innerHTML=`<span class="${t.className}">${t.text}</span>`,setResolved:(e,t)=>e.innerHTML=t,setError:(e,t)=>e.innerHTML=`<span class="juris-async-error">Error: ${t.message}</span>`}):this.#F(e,t,n):this._setStaticAttribute(e,t,n),r.length>0||o.length>0){const t=this.subscriptions.get(e)||{subscriptions:[],eventListeners:[]};t.subscriptions.push(...r),t.eventListeners.push(...o),this.subscriptions.set(e,t)}return()=>{r.forEach((e=>{try{e()}catch(e){}})),o.forEach((({eventName:t,handler:n})=>{try{e.removeEventListener(t,n)}catch(e){}}))}}_handleText(e,t,n){if("function"==typeof t){const s=this.#B(e,(()=>t(e)),(t=>{e.textContent=t}),{trackChanges:!0,name:"text"});this._createReactiveUpdate(e,s,n)}else this.#z(t)?this.#F(e,"text",t,{setLoading:(e,t)=>{e.textContent=t.text,e.className=t.className,t.style&&(e.style.cssText=t.style)},setResolved:(e,t,n)=>{e.textContent=t,e.classList.remove(n.className),n.style&&(e.style.cssText="")},setError:(e,t)=>{e.textContent=`Error: ${t.message}`,e.classList.add("juris-async-error")}}):e.textContent=t}#F(e,t,n,s={}){const r=this._getPlaceholderConfig(e);s.setLoading?s.setLoading(e,r):this.#D(e,t),promisify(n).then((n=>{s.setResolved?s.setResolved(e,n,r):(e.classList.remove(r.className),this._setStaticAttribute(e,t,n))})).catch((n=>{s.setError?s.setError(e,n,r):this.#W(e,t,n.message)}))}_handleStyle(e,t,n){if("function"==typeof t){const s=this.#B(e,(()=>{let n=t.length>0?t(e):t();return this.customCSSExtractor?.postProcessReactiveResult&&"object"==typeof n&&(n=this.customCSSExtractor.postProcessReactiveResult(n,"reactive",e)),n}),(t=>{"object"==typeof t&&Object.assign(e.style,t)}),{trackChanges:!0,name:"style"});this._createReactiveUpdate(e,s,n)}else if(this.#z(t))this.#F(e,"style",t,{setLoading:(e,t)=>{if(e.classList.add(t.className),t.style){t.style.split(";").filter((e=>e.trim())).forEach((t=>{const[n,s]=t.split(":").map((e=>e.trim()));n&&s&&this.#q(e,n,s)}))}},setResolved:(e,t,n)=>{if(e.classList.remove(n.className),"object"==typeof t){if(n.style){n.style.split(";").map((e=>e.split(":")[0].trim())).filter((e=>e)).forEach((t=>e.style.removeProperty(t)))}Object.assign(e.style,t)}}});else if("object"==typeof t)for(const s in t)if(t.hasOwnProperty(s)){const r=t[s];"function"==typeof r?this.#V(e,s,r,n):this.#q(e,s,r)}}#V(e,t,n,s){const r=this.#B(e,(()=>n(e)),(n=>this.#q(e,t,n)),{trackChanges:!0,name:`style property '${t}'`});this._createReactiveUpdate(e,r,s)}_handleReactiveAttribute(e,t,n,s){const r=this.#B(e,(()=>n(e)),(n=>this._setStaticAttribute(e,t,n)),{trackChanges:!0,name:`attribute '${t}'`});this._createReactiveUpdate(e,r,s)}_handleChildren(e,t,n,s=null){"function"==typeof t?this.#Q(e,t,n):this.#z(t)?this.#F(e,"children",t,{setLoading:(e,t)=>{let n;t.children?n=this.render(t.children):(n=document.createElement("div"),n.className=t.className,n.textContent=t.text,t.style&&(n.style.cssText=t.style)),e.appendChild(n),this.asyncPlaceholders.set(e,{type:"children",placeholder:n})},setResolved:(e,t)=>{const n=this.asyncPlaceholders.get(e);n?.placeholder?.parentNode&&e.removeChild(n.placeholder),this.#G(e,t),this.asyncPlaceholders.delete(e)},setError:(e,t)=>{const n=this.asyncPlaceholders.get(e);n?.placeholder&&(n.placeholder.textContent=`Error loading content: ${t.message}`,n.placeholder.className="juris-async-error")}}):this.#G(e,t,s)}#Q(e,t,n){const s=()=>{const{result:r,deps:o}=this.juris.stateManager.track((()=>t(e)));this.#z(r)?(e.textContent="Loading...",promisify(r).then((t=>{"string"==typeof t||"number"==typeof t?e.textContent=String(t):(e.textContent="",this.#G(e,t))})).catch((t=>{e.textContent=`Error: ${t.message}`}))):"ignore"!==r&&("string"==typeof r||"number"==typeof r?e.textContent=String(r):(e.textContent="",this.#G(e,r))),o.forEach((e=>{const t=this.juris.stateManager.subscribeInternal(e,s);n.push(t)}))};s()}#G(e,t,n=null){if("ignore"!==t)if(Array.isArray(t)){t.some((e=>"function"==typeof e))?this.#J(e,t,n):this.#X(e,t,n)}else if(t)if(e.textContent="","function"==typeof t)this.#Y(e,t,n);else{const s=this.#K(t,n);s&&e.appendChild(s)}else e.textContent=""}#$(e){return this.SVG_ELEMENTS.has(e.toLowerCase())?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e)}#U(e,t){if(e.some((e=>"function"==typeof e))){const t=document.createDocumentFragment(),n=[];return this.#Z(t,e,n),n.length>0&&(t._jurisCleanup=()=>{n.forEach((e=>{try{e()}catch(e){}}))}),t}const n=document.createDocumentFragment();for(let s=0;s<e.length;s++){const r=this.render(e[s],t);r&&n.appendChild(r)}return n}#H(e,t){if(!this.juris.componentManager.components.get(e))return log.ee&&console.error(log.e("Component not found",{name:e},"application")),null;if(this.componentStack.includes(e))return this.#u("recursion",[...this.componentStack,e].join(" → "));this.componentStack.push(e);const{result:n}=this.juris.stateManager.track((()=>this.juris.componentManager.create(e,t)),!0);return this.componentStack.pop(),n}#q(e,t,n){t.startsWith("--")?e.style.setProperty(t,n):e.style[t]=n}#u(e,t){const n=document.createElement("div");return n.style.cssText="color: red; border: 1px solid red; padding: 8px; background: #ffe6e6; font-family: monospace;",n.textContent=t,n}_handleEvent(e,t,n,s){const r="onclick"===(t=t.toLowerCase())?"click":this.eventMap[t]||t.slice(2);e.addEventListener(r,n),s.push({eventName:r,handler:n}),"onclick"===t&&this.#ee(e,n,s)}#ee(e,t,n){if(!/Mobi|Android/i.test(navigator.userAgent))return;let s={startTime:0,moved:!1,startX:0,startY:0};[{name:"touchstart",handler:e=>{s.startTime=Date.now(),s.moved=!1,e.touches?.[0]&&(s.startX=e.touches[0].clientX,s.startY=e.touches[0].clientY)},options:{passive:!0}},{name:"touchmove",handler:e=>{if(e.touches?.[0]){const t=Math.abs(e.touches[0].clientX-s.startX),n=Math.abs(e.touches[0].clientY-s.startY);(t>this.TOUCH_CONFIG.moveThreshold||n>this.TOUCH_CONFIG.moveThreshold)&&(s.moved=!0)}},options:{passive:!0}},{name:"touchend",handler:e=>{!s.moved&&Date.now()-s.startTime<this.TOUCH_CONFIG.timeThreshold&&(e.preventDefault(),t(e))},options:{passive:!1}}].forEach((({name:t,handler:s,options:r})=>{e.addEventListener(t,s,r),n.push({eventName:t,handler:s})}))}#Z(e,t,n){for(let s=0;s<t.length;s++){const r=t[s];if("function"==typeof r){let t=document.createTextNode(""),s=[];const o=()=>{s.forEach((e=>{try{e()}catch(e){}})),s=[];const{result:e,deps:n}=this.juris.stateManager.track((()=>r()));if(this.#z(e)){const n=document.createTextNode("Loading...");t.parentNode&&t.parentNode.replaceChild(n,t),t=n,promisify(e).then((e=>{const n=this.#K(e,null,!1)||document.createTextNode("");t.parentNode&&t.parentNode.replaceChild(n,t),t=n})).catch((e=>{const n=document.createTextNode(`Error: ${e.message}`);t.parentNode&&t.parentNode.replaceChild(n,t),t=n}))}else{const n=this.#K(e,null,!1)||document.createTextNode("");t.parentNode&&t.parentNode.replaceChild(n,t),t=n}n.forEach((e=>{const t=this.juris.stateManager.subscribeInternal(e,o);s.push(t)}))};o(),e.appendChild(t),n.push((()=>{s.forEach((e=>{try{e()}catch(e){}}))}))}else if(null!=r){const t=this.#K(r,null,!1);t&&e.appendChild(t)}}}#Y(e,t,n){let s=null;const r=()=>{if(s)try{s()}catch(e){}const{result:o,deps:a}=this.juris.stateManager.track((()=>t(e)));if(this.#z(o))e.textContent="Loading...",promisify(o).then((t=>{e.textContent="";const s=this.#K(t,n,!1);s&&e.appendChild(s)})).catch((t=>{e.textContent=`Error: ${t.message}`}));else{e.textContent="";const t=this.#K(o,n,!1);t&&e.appendChild(t)}if(a.length>0){const e=a.map((e=>this.juris.stateManager.subscribeInternal(e,r)));s=()=>e.forEach((e=>{try{e()}catch(e){}}))}};e._reactiveCleanup=s,r()}#J(e,t,n){e.textContent="";const s=[],r=document.createDocumentFragment();for(let o=0;o<t.length;o++){const a=t[o];if("function"==typeof a){const{node:t,cleanup:i}=this.#te(a,o,n,e);t&&(r.appendChild(t),s.push(i))}else if(null!=a){const e=this.#K(a,n);e&&r.appendChild(e)}}r.hasChildNodes()&&e.appendChild(r),e._reactiveCleanup=()=>{s.forEach((e=>{try{e()}catch(e){}}))}}#te(e,t,n,s){let r=document.createTextNode(""),o=[];const a=()=>{o.forEach((e=>{try{e()}catch(e){}})),o=[];const{result:t,deps:i}=this.juris.stateManager.track((()=>e(s)));if(this.#z(t)){const e=document.createTextNode("Loading...");r.parentNode&&r.parentNode.replaceChild(e,r),r=e,promisify(t).then((e=>{const t=this.#K(e,n)||document.createTextNode("");r.parentNode&&r.parentNode.replaceChild(t,r),r=t})).catch((e=>{const t=document.createTextNode(`Error: ${e.message}`);r.parentNode&&r.parentNode.replaceChild(t,r),r=t}))}else{const e=this.#K(t,n)||document.createTextNode("");r.parentNode&&r.parentNode.replaceChild(e,r),r=e}i.forEach((e=>{const t=this.juris.stateManager.subscribeInternal(e,a);o.push(t)}))};return a(),{node:r,cleanup:()=>{o.forEach((e=>{try{e()}catch(e){}})),o=[]}}}#K(e,t){if(null==e)return null;if("string"==typeof e||"number"==typeof e)return document.createTextNode(String(e));if(Array.isArray(e)){const n=document.createDocumentFragment();for(let s=0;s<e.length;s++){const r=this.#K(e[s],t);r&&n.appendChild(r)}return n.hasChildNodes()?n:null}return"object"==typeof e&&null!==e?this.render(e,t):null}#X(e,t,n){e.textContent="";const s=document.createDocumentFragment();for(let e=0;e<t.length;e++){const r=t[e];if(null!=r){const e=this.#K(r,n);e&&s.appendChild(e)}}s.hasChildNodes()&&e.appendChild(s)}_setStaticAttribute(e,t,n){if(this.SKIP_ATTRS.has(t))return;if(this.BOOLEAN_ATTRS.has(t)){const s=n&&"false"!==n;return s?e.setAttribute(t,""):e.removeAttribute(t),void("checked"!==t||"checkbox"!==e.type&&"radio"!==e.type?"selected"===t&&"OPTION"===e.tagName?e.selected=s:"multiple"===t&&"SELECT"===e.tagName?e.multiple=s:e[t]=s:e.checked=s)}if("http://www.w3.org/2000/svg"===e.namespaceURI)return void e.setAttribute(t,n);switch(t){case"htmlFor":return void e.setAttribute("for",n);case"className":return void(e.className=n)}const s=t.charCodeAt(0);this.PRESERVED_ATTRIBUTES.has(t)||100===s&&45===t.charCodeAt(4)||97===s&&45===t.charCodeAt(4)||-1!==t.indexOf("-")||-1!==t.indexOf(":")?e.setAttribute(t,n):t in e&&"function"!=typeof e[t]?e[t]=n:e.setAttribute(t,n)}_createReactiveUpdate(e,t,n){const{deps:s}=this.juris.stateManager.track((()=>t(e)));s.forEach((e=>{const s=this.juris.stateManager.subscribeInternal(e,t);n.push(s)}))}updateElementContent(e,t){this.#G(e,[t])}setupIndicators(e,t){this.placeholderConfigs.set(e,{...this.defaultPlaceholder,...t})}_hasAsyncProps(e){for(const t in e)if(e.hasOwnProperty(t)&&!t.startsWith("on")&&this.#z(e[t]))return!0;return!1}_getPlaceholderConfig(e){if(e?.id&&this.placeholderConfigs.has(e.id))return this.placeholderConfigs.get(e.id);let t=e?.parentElement;for(;t;){if(t.id&&this.placeholderConfigs.has(t.id))return this.placeholderConfigs.get(t.id);t=t.parentElement}return this.defaultPlaceholder}#D(e,t){const n=this._getPlaceholderConfig(e);({text:()=>{e.textContent=n.text,e.className=n.className,n.style&&(e.style.cssText=n.style)},children:()=>{if(n.children){const t=this.render(n.children);if(t)return void e.appendChild(t)}const t=document.createElement("span");t.textContent=n.text,t.className=n.className,n.style&&(t.style.cssText=n.style),e.appendChild(t)},className:()=>e.classList.add(n.className),style:()=>{n.style&&(e.style.cssText=n.style),e.classList.add(n.className)}}[t]||(()=>{e.setAttribute(t,"loading"),e.classList.add(n.className)}))()}#W(e,t,n){e.classList.add("juris-async-error"),"text"===t?e.textContent=`Error: ${n}`:"children"===t&&(e.innerHTML=`<span class="juris-async-error">Error: ${n}</span>`)}#z(e){return e?.then}cleanup(e){this.juris.componentManager.cleanup(e);const t=this.subscriptions.get(e);if(t&&(t.subscriptions&&t.subscriptions.forEach((e=>{try{e()}catch(e){}})),t.eventListeners&&t.eventListeners.forEach((({eventName:t,handler:n})=>{try{e.removeEventListener(t,n)}catch(e){}})),this.subscriptions.delete(e)),e._reactiveCleanup){try{e._reactiveCleanup()}catch(e){}e._reactiveCleanup=null}this.asyncPlaceholders.has(e)&&this.asyncPlaceholders.delete(e);try{const t=e.children;for(let e=0;e<t.length;e++)try{this.cleanup(t[e])}catch(e){}}catch(e){}}clearCSSCache(){this.customCSSExtractor&&"function"==typeof this.customCSSExtractor.clearCache&&this.customCSSExtractor.clearCache()}}class Juris{static#ne=!1;constructor(e={}){e.logLevel&&this.setupLogging(e.logLevel),this.contextTemplate=null,this.contextCache=new Map,this.services=e.services||{},this.layout=e.layout,this.stateManager=new StateManager(e.states||{},e.middleware||[]),this.componentManager=new ComponentManager(this),this.domRenderer=new DOMRenderer(this),this.armedElements=new Map;const t=e.features||{};t.headless&&(this.headlessManager=new t.headless(this,log),this.headlessAPIs={}),t.enhance&&(this.domEnhancer=new t.enhance(this)),t.template&&(this.templateCompiler=new t.template,e.autoCompileTemplates&&this.compileTemplates()),t.webComponentFactory&&(this.webComponentFactory=new t.webComponentFactory(this)),t.cssExtractor&&(this.domRenderer.customCSSExtractor=new t.cssExtractor),e.headlessComponents&&this.headlessManager&&Object.entries(e.headlessComponents).forEach((([e,t])=>{"function"==typeof t?this.headlessManager.register(e,t):this.headlessManager.register(e,t.fn,t.options)})),e.placeholders&&Object.entries(e.placeholders).forEach((([e,t])=>{this.domRenderer.setupIndicators(e,t)})),e.defaultPlaceholder&&(this.domRenderer.defaultPlaceholder={...this.domRenderer.defaultPlaceholder,...e.defaultPlaceholder}),this.headlessManager&&this.headlessManager.initializeQueued(),e.components&&Object.entries(e.components).forEach((([e,t])=>{this.componentManager.register(e,t)})),"undefined"==typeof requestIdleCallback&&(window.requestIdleCallback=function(e,t){const n=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})}),1)}),this.#se()}#se(){Juris._done||(requestIdleCallback||setTimeout)((()=>{if(!Juris.#ne){Juris.#ne=!0;for(let e in globalThis)globalThis[e]instanceof Juris&&log.ew&&console.warn(`âš ï¸ JURIS GLOBAL: '${e}'`)}}))}getComponentAPI(e){return this.componentManager.getComponentAPI(e)}getComponentElement(e){return this.componentManager.getComponentElement(e)}getNamedComponents(){return this.componentManager.getNamedComponents()}compileTemplates(e=null){if(!this.templateCompiler)return void(log.ew&&console.warn(log.w("Template compilation requested but templateCompiler not available"),"framework"));const t=e||document.querySelectorAll("template[data-component]"),n=this.templateCompiler.compileTemplates(t);Object.entries(n).forEach((([e,t])=>{this.registerComponent(e,t)}))}setupLogging(e){log.ei=!0,log.ed=!0,log.el=!0,log.ew=!0,log.ee=!0;const t={debug:0,info:1,warn:2,error:3}[e]??1;t>0&&(log.ed=!1),t>1&&(log.el&&console.log("Juris logging initialized at level:",e),log.el&&console.log('To change log level, use juris.setupLogging("newLevel") or set logLevel in config'),log.el=!1,log.ei=!1)}setupIndicators(e,t){this.domRenderer.setupIndicators(e,t)}#re(){return this.contextTemplate||(this.contextTemplate={getState:(e,t,n)=>this.stateManager.getState(e,t,n),setState:(e,t,n)=>this.stateManager.setState(e,t,n),executeBatch:e=>this.executeBatch(e),subscribe:(e,t)=>this.stateManager.subscribe(e,t),services:this.services,...this.services||{},...this.headlessAPIs||{},headless:this.headlessManager?.context,isSSR:"undefined"==typeof window,components:{register:(e,t)=>this.componentManager.register(e,t),registerHeadless:(e,t,n)=>this.headlessManager?.register(e,t,n),get:e=>this.componentManager.components.get(e),getHeadless:e=>this.headlessManager?.getInstance(e),initHeadless:(e,t)=>this.headlessManager?.initialize(e,t),reinitHeadless:(e,t)=>this.headlessManager?.reinitialize(e,t),getComponentAPI:e=>this.getComponentAPI(e),getHeadlessAPI:e=>this.headlessManager?.getAPI(e),getComponentElement:e=>this.getComponentElement(e),getNamedComponents:()=>this.componentManager.getNamedComponents()},utils:{render:e=>this.render(e),cleanup:()=>this.cleanup(),forceRender:()=>this.render(),getHeadlessStatus:()=>this.headlessManager?.getStatus(),objectToHtml:e=>this.objectToHtml(e)},objectToHtml:e=>this.objectToHtml(e),setupIndicators:(e,t)=>this.setupIndicators(e,t),juris:this,logger:{log:log,lwarn:log.w,error:log.e,info:log.i,debug:log.d,subscribe:logSub,unsubscribe:logUnsub}}),this.contextTemplate}createHeadlessContext(e=null){return this.createContext(e)}executeBatch(e){return this.stateManager.executeBatch(e)}createWebComponent(e,t,n={}){return this.webComponentFactory?this.webComponentFactory.create(e,t,n):(log.ee&&console.error(log.e("WebComponent creation requested but webComponentFactory not available"),"application"),null)}createWebComponents(e,t={}){return this.webComponentFactory?this.webComponentFactory.createMultiple(e,t):(log.ee&&console.error(log.e("WebComponents creation requested but webComponentFactory not available"),"framework"),{})}createContext(e=null){const t={...this.#re()};if(this.headlessManager){const e=this.headlessManager.getAllAPIs();Object.assign(t,e)}return e&&(t.element=e),t}getState(e,t,n){return this.stateManager.getState(e,t,n)}setState(e,t,n){return this.stateManager.setState(e,t,n)}subscribe(e,t,n=!0){return this.stateManager.subscribe(e,t,n)}subscribeExact(e,t){return this.stateManager.subscribeExact(e,t)}registerComponent(e,t){return this.componentManager.register(e,t)}registerHeadlessComponent(e,t,n){return this.headlessManager.register(e,t,n)}initializeQueuedHeadlessComponent(){this.headlessManager.initializeQueued()}initializeHeadlessComponent(e,t){return this.headlessManager.initialize(e,t)}getHeadlessComponent(e){return this.headlessManager.getInstance(e)}getHeadlessAPI(e){return this.headlessManager?.getAPI(e)}getComponent(e){return this.componentManager.components.get(e)}registerAndInitHeadless(e,t,n={}){return this.headlessManager.register(e,t,n),this.headlessManager.initialize(e,n)}getHeadlessStatus(){return this.headlessManager.getStatus()}objectToHtml(e){return this.domRenderer.render(e)}render(e="#app"){const t=performance.now(),n="string"==typeof e?document.querySelector(e):e;if(!n)return void(log.ee&&console.error(log.e("Render container not found",{container:e},"application")));const s=this.getState("isHydration",!1);try{if(Array.isArray(this.layout)){if(this.layout.some((e=>"function"==typeof e))){n.innerHTML="";const e=[];this.domRenderer._handleChildren(n,this.layout,e),e.length>0&&this.domRenderer.subscriptions.set(n,{subscriptions:e,eventListeners:[]});const s=performance.now()-t;return void(log.ei&&console.info(log.i("Render completed (reactive array)",{duration:`${s.toFixed(2)}ms`},"application")))}}s?this.#oe(n):this.#ae(n);const e=performance.now()-t;log.ei&&console.info(log.i("Render completed",{duration:`${e.toFixed(2)}ms`,isHydration:s},"application"))}catch(t){log.ee&&console.error(log.e("Render failed",{error:t.message,container:e},"application")),this.#ie(n,t)}}#ae(e){e.innerHTML="";const t=this.domRenderer.render(this.layout);t&&e.appendChild(t)}async#oe(e){const t=document.createElement("div");t.style.cssText="position: absolute; left: -9999px; visibility: hidden;",document.body.appendChild(t);try{startTracking();const n=this.domRenderer.render(this.layout);for(n&&t.appendChild(n),await onAllComplete(),e.innerHTML="";t.firstChild;)e.appendChild(t.firstChild);this.headlessManager.initializeQueued()}finally{stopTracking(),document.body.removeChild(t)}}#ie(e,t){const n=document.createElement("div");n.style.cssText="color: red; border: 2px solid red; padding: 16px; margin: 8px; background: #ffe6e6;",n.innerHTML=`\n            <h3>Render Error</h3>\n            <p><strong>Message:</strong> ${t.message}</p>\n            <pre style="background: #f5f5f5; padding: 8px; overflow: auto;">${t.stack||""}</pre>\n        `,e.appendChild(n)}enhance(e,t,n){return this.domEnhancer.enhance(e,t,n)}configureEnhancement(e){if(this.domEnhancer)return this.domEnhancer.configure(e);log.ew&&console.warn(log.w("Enhancement configuration requested but domEnhancer not available"),"framework")}arm(e,t){const n=this.createContext(e),s=t(n),r=[],o=this;for(const t in s){let n;n=t.startsWith("on-")||t.startsWith("on:")?t.slice(3):t.slice(2).toLowerCase();const o=s[t];"function"==typeof o&&(e.addEventListener(n,o),r.push({original:t,actual:n,handler:o}))}const a={events:r.map((e=>({name:e.original,actualEvent:e.actual,handler:e.handler}))),trigger(t,n={}){const s=r.find((e=>e.original===t||e.actual===t));if(s){const t={type:s.actual,target:e,preventDefault:()=>{},stopPropagation:()=>{},...n};return s.handler.call(e,t),!0}return!1},cleanup:()=>(r.forEach((({actual:t,handler:n})=>{e.removeEventListener(t,n)})),o.armedElements.delete(e),!0)};return o.armedElements.set(e,{listeners:r,context:n,instance:a}),a}cleanup(){this.armedElements=new Map,this.headlessManager?.cleanup()}destroy(){this.cleanup(),this.domEnhancer&&this.domEnhancer.destroy(),this.stateManager.subscribers.clear(),this.stateManager.externalSubscribers.clear(),this.componentManager.components.clear(),this.headlessManager&&this.headlessManager.components.clear(),this.armedElements=new Map}}